<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Kubewarden architecture :: Rancher product documentation</title>
    <link rel="canonical" href="https://documentation.suse.com/cloudnative/policy-manager/1.22/en/explanations/architecture.html">
    <link rel="prev" href="context-aware-policies.html">
    <link rel="next" href="../howtos/tasks.html">
    <meta name="description" content="The Kubewarden architecture">
    <meta name="keywords" content="["kubewarden", "kubernetes", "architecture"]">
    <meta name="generator" content="Antora 3.1.10">
    <link rel="stylesheet" href="../../../../_/css/site.css">
<link rel="stylesheet" href="../../../../_/css/search.css">
<link rel="icon" href="../../../../_/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="../../../../_/css/font-styles.css">
<link rel="stylesheet" href="../../../../_/fonts/css/all.css">
<link rel="stylesheet" href="../../../../_/css/site-extra.css">
<link rel="stylesheet" href="../../../../_/css/vendor/tabs.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link
href="https://fonts.googleapis.com/css2?family=SUSE:wght@100..800&display=swap" rel="stylesheet">
<link href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css" rel="stylesheet">
<!-- <link href="https://fonts.googleapis.com/css?family=Montserrat|Roboto&display=swap" rel="stylesheet"> -->
<link rel="stylesheet" href="../../../../_/css/vendor/light.css">
<!-- <script src="/docserv/res/lightheaded/analytics.js"
        type="text/javascript"></script> -->
    <script>var uiRootPath = '../../../../_'</script>
  </head>
  <body class="article">
<script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs'; mermaid.initialize({"startOnLoad":true});</script><header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <div class="navbar-item">
        <a class=" navbar-logo" href="https://documentation.suse.com/" aria-label="SUSE Documentation Home"><img class="logo"
            src="../../../../_/img/logo.svg" alt="SUSE logo"/></a>
      </div>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <label class="visual-search-label" for="search-input">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label>
          <input label="Search" aria-label="Search" id="search-input" type="text" placeholder="Search the docs" >
        </div>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link">
            <img src="../../../../_/img/resources.png" class="langIcon Resurces" alt="Resources" title="Resources">
          </div>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://github.com/rancher/kubewarden-product-docs"><i class="fab fa-github"></i>&nbsp;Policy Manager</a>
            <div class="has-submenu">
              <a class="navbar-item" href="#" ><i class="fas fa-file-alt"></i>&nbsp;Report Issue &nbsp;<i class="fas fa-chevron-right"></i></a>
              <div class="submenu">
                <a class="navbar-item" href="https://scc.suse.com">SCC (Recommended)</a>
                <a class="navbar-item" href="https://github.com/rancher/kubewarden-product-docs/issues">GitHub Issue</a>
              </div>
            </div>
            <a class="navbar-item" href="https://github.com/rancher/product-docs-playbook/blob/main/CONTRIBUTING.md"><i class="fas fa-user-edit"></i>&nbsp;Contribute</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link"><img src="../../../../_/img/language.png" class="langIcon Language" alt="Language"
              title="Language"></div>
          <div class="navbar-dropdown">
            <!--  </div><div>Icons made by <a href="https://www.flaticon.com/authors/freepik" title="Freepik">Freepik</a> from <a href="https://www.flaticon.com/" title="Flaticon">www.flaticon.com</a></div> -->
              <a role="button" class="navbar-item" id="en" onclick="selectLanguage(this.id)">
                <!--<img src="../../../../_/img/engFlag.svg" class="langIcon english">-->
                &nbsp;English
              </a>
            <!-- LANGUAGESELECTOR -->
          </div>
        </div>
        <!--
        <div class="navbar-item">
          <a href="https://twitter.com/SUSE">
            <img alt="X-logo" class="x-logo" src="../../../../_/img/x-logo-white.png">
          </a>
        </div>
        -->
      </div>
    </div>

    <!--   <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">

        </div>
        <div class="navbar-item">
          <span class="control">
          </span>
        </div>
        <div class="navbar-item">
          <span class="control">
          </span>
        </div>
        <div class="navbar-item">
          <span class="control">
          </span>
        </div>
        <div class="navbar-item">
          <span class="control">
          </span>
        </div>
      </div> -->
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="policy-manager" data-version="1.16">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="../introduction.html">Policy Manager</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../introduction.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../quick-start.html">Quick start</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Tutorials</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../tutorials/writing-policies/index.html">Writing Kubewarden policies</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../tutorials/writing-policies/CEL/01-intro-cel.html">Introduction to CEL</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/CEL/02-reusing-vap.html">Reusing ValidatingAdmissionPolicies</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/CEL/03-context-aware.html">Context-aware CEL policies</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/CEL/04-example-sigstore.html">Sigstore host capabilities</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../tutorials/writing-policies/rust/01-intro-rust.html">Rust</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/rust/02-create-policy.html">Creating a policy</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/rust/03-define-policy-settings.html">Defining policy settings</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/rust/04-write-validation-logic.html">Writing validation logic</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/rust/05-mutation-policy.html">Creating a new mutation policy</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/rust/06-logging.html">Logging</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/rust/07-build-and-distribute.html">Building and distributing policies</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/rust/08-raw-policies.html">Raw policies</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../tutorials/writing-policies/go/01-intro-go.html">Writing policies in Go</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/go/02-scaffold.html">Creating a new validation policy</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/go/03-policy-settings.html">Defining policy settings</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/go/04-validation.html">Writing the validation logic</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/go/05-e2e-tests.html">End-to-end testing</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/go/06-logging.html">Logging</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/go/07-automate.html">Integrating with GitHub Actions</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/go/08-distribute.html">Distributing policy</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/go/09-validation-with-queries.html">Validation using JSON queries</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/go/10-raw-policies.html">Writing raw policies</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../tutorials/writing-policies/rego/01-intro-rego.html">Rego</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/rego/02-builtin-support.html">Builtin support</a>
  </li>
  <li class="nav-item" data-depth="4">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Open Policy Agent</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tutorials/writing-policies/rego/open-policy-agent/01-intro.html">Introduction to Open Policy Agent</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tutorials/writing-policies/rego/open-policy-agent/02-create-policy.html">Creating a new policy</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tutorials/writing-policies/rego/open-policy-agent/03-build-and-run.html">Build and run a OPA policy for Kubewarden</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tutorials/writing-policies/rego/open-policy-agent/04-distribute.html">Distributing an OPA policy with Kubewarden</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tutorials/writing-policies/rego/open-policy-agent/05-raw-policies.html">Writing raw policies</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="4">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Gatekeeper</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tutorials/writing-policies/rego/gatekeeper/01-intro.html">Gatekeeper support</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tutorials/writing-policies/rego/gatekeeper/02-create-policy.html">Creating a new Gatekeeper Rego policy</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tutorials/writing-policies/rego/gatekeeper/03-build-and-run.html">Build and run a Gatekeeper policy</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tutorials/writing-policies/rego/gatekeeper/04-distribute.html">Distributing a Gatekeeper policy with Kubewarden</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tutorials/writing-policies/dotnet.html">C#</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tutorials/writing-policies/swift.html">Swift</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tutorials/writing-policies/typescript.html">Typescript</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tutorials/writing-policies/other-languages.html">Other languages</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">WASI</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/wasi/01-intro-wasi.html">WASI</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/wasi/02-raw-policies.html">Writing raw policies</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tutorials/writing-policies/metadata.html">Policy metadata</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Testing policies</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tutorials/testing-policies/index.html">Policy testing</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tutorials/testing-policies/02-policy-authors.html">Testing for policy authors</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tutorials/testing-policies/03-cluster-operators.html">Testing for cluster operators</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tutorials/verifying-kubewarden.html">Verifying Kubewarden</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tutorials/publish-policy-to-artifact-hub.html">Publish policies to Artifact Hub</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Explanations</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="mutating-policies.html">Mutating policies</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="distributing-policies.html">Distributing policies</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Comparisons</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="comparisons/opa-comparison.html">Kubewarden vs OPA Gatekeeper</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="audit-scanner/audit-scanner.html">What is the Audit Scanner?</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="audit-scanner/limitations.html">Audit Scanner - Limitations</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="audit-scanner/policy-reports.html">Audit Scanner - Policy Reports</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="context-aware-policies.html">Context aware policies</a>
  </li>
</ul>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="architecture.html">Kubewarden architecture</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Howtos</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../howtos/tasks.html">Common tasks</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../howtos/psp-migration.html">PodSecurityPolicy migration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../howtos/pod-security-admission-with-kubewarden.html">Using Pod Security Admission with Kubewarden</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../howtos/secure-supply-chain.html">Secure supply chain</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../howtos/custom-certificate-authorities.html">Custom certificate authorities</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../howtos/raw-policies.html">Raw policies</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../howtos/audit-scanner.html">Audit Scanner</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Configuring Policy Servers</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/policy-servers/01-custom-cas.html">Using custom certificate authorities</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/policy-servers/02-private-registry.html">Configuring PolicyServers to use private registries</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/policy-servers/03-production-deployments.html">Configuring PolicyServers for production</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../howtos/policies.html">Configuring policies</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Airgap</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/airgap/01-requirements.html">Requirements for a Kubewarden air gap installation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/airgap/02-install.html">Air gap installation</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Rancher UI extension</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/ui-extension/01-install.html">Rancher UI extension quickstart</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/ui-extension/02-metrics.html">Monitoring</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/ui-extension/03-tracing.html">Tracing</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Telemetry quick starts</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/telemetry/20-tracing-qs.html">Tracing quickstart</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/telemetry/30-metrics-qs.html">Metrics quickstart</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../howtos/telemetry/10-opentelemetry-qs.html">Open Telemetry quick start</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../howtos/Rancher-Fleet.html">Managing Kubewarden with Rancher Fleet</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../howtos/contribution-guide/contribution-guide.html">Contribution guide</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/contribution-guide/contributing.html">Contributing to Kubewarden documentation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/contribution-guide/suggesting-an-improvement.html">Suggesting a doc improvement</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Reference</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/CRDs.html">Custom Resource Definitions (CRD)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/dependency-matrix.html">Dependency matrix</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/upgrade-path.html">Upgrade path</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/metrics-reference.html">Metrics reference</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/monitor-mode.html">Monitor mode</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Policy specification</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../reference/spec/01-intro-spec.html">Policy communication specification</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../reference/spec/02-settings.html">Policy settings</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../reference/spec/03-validating-policies.html">Validating policies</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../reference/spec/04-mutating-policies.html">Mutating policies</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../reference/spec/05-context-aware-policies.html">Context aware policies</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Host capabilities</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../reference/spec/host-capabilities/01-intro-host-capabilities.html">Host capabilities specification</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../reference/spec/host-capabilities/02-signature-verifier-policies.html">Signature verifier policies</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../reference/spec/host-capabilities/03-container-registry.html">Container registry capabilities</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../reference/spec/host-capabilities/04-net.html">Network capabilities</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../reference/spec/host-capabilities/05-crypto.html">Cryptographic capabilities</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../reference/spec/host-capabilities/06-kubernetes.html">Kubernetes capabilities</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/oci-registries-support.html">OCI registry support for Kubewarden</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/threat-model.html">Threat Model</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/policy-evaluation-timeout.html">Policy evaluation timeout protection</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/verification-config.html">Verification configuration format</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/sources_yaml.html">Reference for sources.yaml</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../glossary.html">Glossary</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../disclosure.html">Security disclosure</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Policy Manager</span>
    <span class="version">1.16</span>
  </div>
  <ul class="components">
        <li class="component">
          <div class="title"><a href="../../../../cluster-api/v0.16/en/index.html">Cluster API</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../cluster-api/v0.16/en/index.html">0.16</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.15/en/index.html">0.15</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.14/en/index.html">0.14</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.13/en/index.html">0.13</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.12/en/index.html">0.12</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.11/en/index.html">0.11</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../continuous-delivery/v0.11/en/index.html">Continuous Delivery</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../continuous-delivery/v0.11/en/index.html">0.11</a>
            </li>
            <li class="version">
              <a href="../../../../continuous-delivery/v0.10/en/index.html">0.10</a>
            </li>
            <li class="version">
              <a href="../../../../continuous-delivery/v0.9/en/index.html">0.9</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../k3s/latest/en/introduction.html">K3s</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../k3s/latest/en/introduction.html">Latest</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../os-manager/1.6/en/index.html">OS Manager</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../os-manager/1.6/en/index.html">1.6</a>
            </li>
            <li class="version">
              <a href="../../../../os-manager/1.5/en/index.html">1.5</a>
            </li>
          </ul>
        </li>
        <li class="component is-current">
          <div class="title"><a href="../../../1.22/en/introduction.html">Policy Manager</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../1.22/en/introduction.html">1.22-next</a>
            </li>
            <li class="version">
              <a href="../../../1.21/en/introduction.html">1.21</a>
            </li>
            <li class="version">
              <a href="../../../1.20/en/introduction.html">1.20</a>
            </li>
            <li class="version">
              <a href="../../../1.19/en/introduction.html">1.19</a>
            </li>
            <li class="version">
              <a href="../../../1.18/en/introduction.html">1.18</a>
            </li>
            <li class="version">
              <a href="../../../1.17/en/introduction.html">1.17</a>
            </li>
            <li class="version is-current">
              <a href="../introduction.html">1.16</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../rke2/latest/en/introduction.html">RKE2</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../rke2/latest/en/introduction.html">Latest</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../rancher-manager/latest/en/about-rancher/what-is-rancher.html">SUSE速 Rancher Manager</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../rancher-manager/latest/en/about-rancher/what-is-rancher.html">Latest</a>
            </li>
            <li class="version">
              <a href="../../../../rancher-manager/v2.10/en/about-rancher/what-is-rancher.html">v2.10</a>
            </li>
            <li class="version">
              <a href="../../../../rancher-manager/v2.9/en/about-rancher/what-is-rancher.html">v2.9</a>
            </li>
            <li class="version">
              <a href="../../../../rancher-manager/v2.8/en/about-rancher/what-is-rancher.html">v2.8</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../security/5.4/en/overview.html">SUSE速 Security</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../security/5.4/en/overview.html">5.4</a>
            </li>
            <li class="version">
              <a href="../../../../security/5.3/en/overview.html">5.3</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../storage/1.9.0/en/longhorn-documentation.html">SUSE速 Storage</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../storage/1.9.0/en/longhorn-documentation.html">1.9.0 (Dev)</a>
            </li>
            <li class="version">
              <a href="../../../../storage/1.8.0/en/longhorn-documentation.html">1.8.0 (Latest)</a>
            </li>
            <li class="version">
              <a href="../../../../storage/1.7.0/en/longhorn-documentation.html">1.7.0</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../virtualization/v1.5/en/introduction/overview.html">SUSE速 Virtualization</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../virtualization/v1.5/en/introduction/overview.html">v1.5 (Dev)</a>
            </li>
            <li class="version">
              <a href="../../../../virtualization/v1.4/en/introduction/overview.html">v1.4 (Latest)</a>
            </li>
            <li class="version">
              <a href="../../../../virtualization/v1.3/en/introduction/overview.html">v1.3</a>
            </li>
          </ul>
        </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../../rancher-manager/latest/en/about-rancher/what-is-rancher.html" aria-label="Home" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../introduction.html">Policy Manager</a></li>
    <li>Explanations</li>
    <li><a href="architecture.html">Kubewarden architecture</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">1.16</button>
  <div class="version-menu">
    <a class="version" href="../../../1.22/en/explanations/architecture.html">1.22-next</a>
    <a class="version" href="../../../1.21/en/explanations/architecture.html">1.21</a>
    <a class="version" href="../../../1.20/en/explanations/architecture.html">1.20</a>
    <a class="version" href="../../../1.19/en/explanations/architecture.html">1.19</a>
    <a class="version" href="../../../1.18/en/explanations/architecture.html">1.18</a>
    <a class="version" href="../../../1.17/en/explanations/architecture.html">1.17</a>
    <a class="version is-current" href="architecture.html">1.16</a>
  </div>
</div>
  <div class="edit-this-page"><a href="https://github.com/rancher/kubewarden-product-docs/edit/main/docs/version-1.16/modules/en/pages/explanations/architecture.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="On this page" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Kubewarden architecture</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Kubewarden is a Kubernetes policy engine.
It uses policies written in a programming language of your choosing.
This language must generate a WebAssembly binary for Kubewarden to use.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_what_is_a_policy"><a class="anchor" href="#_what_is_a_policy"></a>What <em>is</em> a policy?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A policy is an <a href="https://opencontainers.org/">Open Container Initiative</a> (OCI)
artifact containing a WebAssembly module,
the policy code, and the metadata required by PolicyServer
performing admission request validations and mutations.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In the same manner as
<a href="https://kubernetes.io/docs/contribute/style/style-guide/">Kubernetes</a>,
Kubewarden uses the terms
'PolicyServer' when discussing the Kubewarden policy server
and
<code>policy-server</code> when discussing Pod or Deployment of a Kubewarden PolicyServer.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_design_principles"><a class="anchor" href="#_design_principles"></a>Design principles</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_making_use_of_core_kubernetes_features"><a class="anchor" href="#_making_use_of_core_kubernetes_features"></a>Making use of core Kubernetes features</h3>
<div class="paragraph">
<p>The team designed Kubewarden to use core features of Kubernetes,
without reinventing the wheel.
The project utilizes a combination of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Kubernetes Controllers</p>
</li>
<li>
<p>Custom Resource Definitions (CRDs)</p>
</li>
<li>
<p>Webhooks (Validation and Mutating)</p>
</li>
<li>
<p>the Control Plane&#8217;s event notification system</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_effectively_uses_kubernetes_architecture"><a class="anchor" href="#_effectively_uses_kubernetes_architecture"></a>Effectively uses Kubernetes architecture</h3>
<div class="paragraph">
<p>Kubewarden operates seamlessly within the Kubernetes ecosystem.
At its core, the Kubewarden controller is a Kubernetes controller,
monitoring Kubewarden Custom Resource Definitions (CRDs)
and configuring Kubernetes resources to execute them.
This integration ensures that Kubewarden uses the built-in Kubernetes mechanisms,
such as controllers and CRDs, to watch, manage, and apply security policies efficiently.</p>
</div>
</div>
<div class="sect2">
<h3 id="_extensible_policy_definition"><a class="anchor" href="#_extensible_policy_definition"></a>Extensible policy definition</h3>
<div class="paragraph">
<p>Kubewarden employs CRDs to define and manage Kubewarden resources,
which specify the rules for admission request validations.
This design enables users to extend Kubernetes' capabilities with custom admission controls,
ensuring that security and compliance policy enforcement is consistent across the cluster.</p>
</div>
</div>
<div class="sect2">
<h3 id="_direct_admission_control"><a class="anchor" href="#_direct_admission_control"></a>Direct admission control</h3>
<div class="paragraph">
<p>When setup by the Kubewarden controller,
the policy-server Service receives admission requests directly from the Kubernetes control plane,
using <code>ValidationWebhooks</code> and <code>MutatingWebhooks</code>.
This direct interaction streamlines the admission control process,
reducing latency and increasing efficiency in policy enforcement.</p>
</div>
<div class="paragraph">
<p>WebAssembly offers a sand-boxed execution environment,
ensuring policies run in isolation,
thus enhancing the security and stability of the policy enforcement mechanism.
This isolation prevents policies from interfering with each other or with the host system,
mitigating the risk of malicious code execution.
WebAssembly is portable and efficient,
enabling policies to run across different environments without modification.
This cross-platform compatibility ensures that Kubewarden policies are versatile,
and can be distributed and executed in diverse Kubernetes clusters</p>
</div>
</div>
<div class="sect2">
<h3 id="_oci_based_policy_artifacts"><a class="anchor" href="#_oci_based_policy_artifacts"></a>OCI based policy artifacts</h3>
<div class="paragraph">
<p>Policies in Kubewarden are OCI (Open Container Initiative) artifacts.
This standardization makes the distribution and versioning of policies easier,
Policies contain both the WebAssembly modules for enforcement logic,
and metadata necessary for the PolicyServer&#8217;s operation.
Leveraging OCI artifacts promotes interoperability and ease of management
within cloud ecosystems.</p>
</div>
</div>
<div class="sect2">
<h3 id="_fine_grained_policy_application"><a class="anchor" href="#_fine_grained_policy_application"></a>Fine-grained policy application</h3>
<div class="paragraph">
<p>Kubewarden associates policies with their own 'validation' or 'mutating' webhook,
allowing for fine-grained application of admission controls.
This flexibility enables administrators
to tailor the enforcement of policies according to specific needs,
enhancing the security and compliance posture of the Kubernetes cluster.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_kubewarden_stack"><a class="anchor" href="#_the_kubewarden_stack"></a>The Kubewarden stack</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Kubewarden consists of these components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Kubewarden Custom Resources are
<a href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/">Kubernetes Custom Resources</a>
that simplify the process of managing policies.</p>
<div class="paragraph">
<p>Kubewarden integrates with Kubernetes using
<a href="https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/">Dynamic Admission Control</a>.
In particular, Kubewarden operates as a Kubernetes Admission Webhook.
The <code>policy-server</code> is the Webhook endpoint called by the Kubernetes API server to validate requests.</p>
</div>
</li>
<li>
<p>The <a href="https://github.com/kubewarden/kubewarden-controller">Kubewarden controller</a>
is a Kubernetes controller that reconciles Kubewarden&#8217;s Custom Resources.
This controller creates parts of the Kubewarden stack.
It also translates Kubewarden configuration into Kubernetes directives.</p>
<div class="paragraph">
<p>The <code>kubewarden-controller</code> registers the needed
<code>MutatingWebhookConfiguration</code> or
<code>ValidatingWebhookConfiguration</code>
objects with the Kubernetes API server.</p>
</div>
</li>
<li>
<p><a href="../tutorials/writing-policies/index.html" class="xref page">Kubewarden policies</a>
are WebAssembly modules holding the validation or mutation logic.
WebAssembly modules have detailed documentation in the
<a href="../tutorials/writing-policies/index.html" class="xref page">writing policies</a> sections.</p>
</li>
<li>
<p>The <a href="https://github.com/kubewarden/policy-server">PolicyServer</a>
receives requests for validation.
It validates the requests by executing Kubewarden policies.</p>
</li>
<li>
<p>The <a href="https://github.com/kubewarden/audit-scanner">audit scanner</a>
inspects the resources already in the cluster.
It identifies those violating Kubewarden policies.</p>
<div class="paragraph">
<p><a href="audit-scanner/audit-scanner.html" class="xref page">Audit scanner</a>
constantly checks the resources declared in the cluster,
flagging the ones that no longer adhere with the deployed Kubewarden policies.</p>
</div>
<div class="imageblock"><div class="mermaid content" style=" ">%%{
  init: {
    "flowchart": {
      "htmlLabels": false,
    }
  }
}%%
graph LR
    subgraph " "
      direction LR
      subgraph " "
        direction LR
          k8s(("Kubernetes"))
          registry[("OCI registry")]
        end
        subgraph kw["`**Kubewarden**`"]
          controller("`**KW controller**`")
          subgraph policy-server["`**policy-server**`"]
            direction LR
            kw-policy-1{{"Policy 1"}}
            kw-policy-2{{"Policy 2"}}
            kw-policy-3{{"Policy 3"}}
        end
        webhooks(["ValidationWebhooks and\nMutatingWebhooks"])
        audit-scanner["KW audit scanner"]
      end
    end
    policy-server -->|"downloads\npolicies from"| registry
    controller -->|"watches for\nevents"| k8s
    controller -->|"creates"| webhooks
    controller -->|"creates\npolicy-server\ninstances"| policy-server
    k8s -. "sends admission\nrequests using" .-> webhooks
    webhooks -. "sent admission\nrequests from K8s" .-> policy-server
    audit-scanner -->|"sends audit\nadmission requests"| policy-server</div></div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_journey_of_a_kubewarden_policy"><a class="anchor" href="#_the_journey_of_a_kubewarden_policy"></a>The journey of a Kubewarden policy</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_default_policyserver"><a class="anchor" href="#_default_policyserver"></a>Default PolicyServer</h3>
<div class="paragraph">
<p>On a new cluster, the Kubewarden components defined are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Custom Resource Definitions (CRD)</p>
</li>
<li>
<p>The <code>kubewarden-controller</code> Deployment</p>
</li>
<li>
<p>A PolicyServer Custom Resource named <code>default</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When the <code>kubewarden-controller</code> notices the default PolicyServer resource,
it creates a <code>policy-server</code> deployment of the PolicyServer component.</p>
</div>
<div class="paragraph">
<p>Kubewarden works as a Kubernetes Admission Webhook.
Kubernetes specifies using
<a href="https://en.wikipedia.org/wiki/Transport_Layer_Security">Transport Layer Security</a>
(TLS) to secure all Webhook endpoints.
The <code>kubewarden-controller</code> sets up this secure communication
by:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Generating a self-signed Certificate Authority</p>
</li>
<li>
<p>Use this CA to generate a TLS certificate key for the <code>policy-server</code> Service.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>These objects are all stored as <code>Secret</code> resources in Kubernetes.</p>
</div>
<div class="paragraph">
<p>Finally, <code>kubewarden-controller</code> creates the <code>policy-server</code> Deployment
and a Kubernetes ClusterIP Service
to expose it inside the cluster network.</p>
</div>
</div>
<div class="sect2">
<h3 id="_defining_the_first_policy"><a class="anchor" href="#_defining_the_first_policy"></a>Defining the first policy</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>A policy must define which <code>policy-server</code> it must run on.
It <strong>binds</strong> to a <code>policy-server</code> instance.
You can have different policies with the same Wasm module and settings
running in many PolicyServers.
However, you can&#8217;t have a single policy definition that runs in many PolicyServers.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>kubewarden-controller</code> notices the new <code>ClusterAdmissionPolicy</code> resource and
so finds the bound <code>policy-server</code> and reconciles it.</p>
</div>
</div>
<div class="sect2">
<h3 id="_reconciliation_of_a_policy_server"><a class="anchor" href="#_reconciliation_of_a_policy_server"></a>Reconciliation of a <code>policy-server</code></h3>
<div class="paragraph">
<p>When creating, modifying or deleting a <code>ClusterAdmissionPolicy</code> or <code>AdmissionPolicy</code>,
a reconciliation loop activates in <code>kubewarden-controller</code>,
for the <code>policy-server</code> owning the policy.
This reconciliation loop creates a <code>ConfigMap</code> with all the policies bound to the <code>policy-server</code>.
Then the Deployment rollout of the <code>policy-server</code> starts.
It results in starting the new <code>policy-server</code> instance with the updated configuration.</p>
</div>
<div class="paragraph">
<p>At start time, the <code>policy-server</code> reads its configuration from the ConfigMap
and downloads all the Kubewarden policies specified.
You can download Kubewarden policies from remote HTTP servers and container registries.</p>
</div>
<div class="paragraph">
<p>You use policy settings parameters to tune a policies' behavior.
After startup and policy download the <code>policy-server</code>
checks the policy settings provided by the user are valid.</p>
</div>
<div class="paragraph">
<p>The <code>policy-server</code> validates policy settings by invoking
the <code>validate_setting</code> function exposed by each policy.
There is further documentation in the
<a href="../reference/spec/01-intro-spec.html" class="xref page">specification reference</a>
section of the documentation.</p>
</div>
<div class="paragraph">
<p>If one or more policies received wrong configuration parameters,
from the policy specification provided by the user,
then any admission requests evaluated by that policy return an error.</p>
</div>
<div class="paragraph">
<p>When Kubewarden has configured all policies,
the <code>policy-server</code>
spawns a pool of worker threads to evaluate incoming requests
using the Kubewarden policies specified by the user.</p>
</div>
<div class="paragraph">
<p>Finally, the <code>policy-server</code> starts a HTTPS server,
listening to incoming validation requests.
Kubewarden uses the TLS key and certificate
created by the Kubewarden controller
to secure the web server.</p>
</div>
<div class="paragraph">
<p>The web server exposes each policy by a dedicated path
following the naming convention: <code>/validate/&lt;policy ID&gt;</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_making_kubernetes_aware_of_the_policy"><a class="anchor" href="#_making_kubernetes_aware_of_the_policy"></a>Making Kubernetes aware of the policy</h3>
<div class="paragraph">
<p>All <code>policy-server</code> instances have a
<a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/"><code>Readiness Probe</code></a>,
that <code>kubewarden-controller</code> uses to check when
the <code>policy-server</code> Deployment is ready to evaluate an
<a href="https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/#webhook-request-and-response"><code>AdmissionReview</code></a>.</p>
</div>
<div class="paragraph">
<p>Once Kubewarden marks the <code>policy-server</code> deployment as 'uniquely reachable' or <code>Ready</code>,
the <code>kubewarden-controller</code> makes the Kubernetes API server aware of the new policy.
This is by creating either a <code>MutatingWebhookConfiguration</code> or a <code>ValidatingWebhookConfiguration</code> object.
In this context, 'uniquely reachable',
means that all the PolicyServer instances in the cluster have the latest policy configuration installed.
The distinction, is a fine point, but is necessary,
due to how roll-out of PolicyServers works.
It&#8217;s possible to have the same policy,
on different PolicyServers with different configurations.</p>
</div>
<div class="paragraph">
<p>Each policy has a dedicated
<code>MutatingWebhookConfiguration</code> or <code>ValidatingWebhookConfiguration</code>
pointing to the Webhook endpoint served by <code>policy-server</code>.
The endpoint is reachable at the <code>/validate/&lt;policy ID&gt;</code> URL.</p>
</div>
</div>
<div class="sect2">
<h3 id="_policy_in_action"><a class="anchor" href="#_policy_in_action"></a>Policy in action</h3>
<div class="paragraph">
<p>Now that all the necessary plumbing is complete,
Kubernetes starts sending Admission Review requests to the right <code>policy-server</code> endpoints.</p>
</div>
<div class="paragraph">
<p>A <code>policy-server</code> receives the Admission Request object and,
based on the endpoint that received the request,
uses the correct policy to evaluate it.</p>
</div>
<div class="paragraph">
<p>Kubewarden evaluates each policy inside its own dedicated WebAssembly sand-box.
The communication between a <code>policy-server</code> instance (the "host")
and the WebAssembly policy (the "guest")
uses the waPC communication protocol.
The protocol description is part of the
<a href="../tutorials/writing-policies/index.html" class="xref page">writing policies</a> documentation.
Policies can also use the interfaces provided by the
<a href="../tutorials/writing-policies/wasi/01-intro-wasi.html" class="xref page">Web Assembly System Interface</a>
(WASI).</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_kubewarden_handles_many_policyserver_and_policies"><a class="anchor" href="#_how_kubewarden_handles_many_policyserver_and_policies"></a>How Kubewarden handles many PolicyServer and policies</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A cluster can have many PolicyServers and Kubewarden policies defined.
There are benefits of having many PolicyServers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You can isolate noisy namespaces or tenants,
those generating many policy evaluations,
from the rest of the cluster so as not to adversely affect other cluster operations.</p>
</li>
<li>
<p>You can run mission-critical policies in a dedicated PolicyServer pool,
making your infrastructure more resilient.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A PolicyServer resource defines each <code>policy-server</code>
and a <code>ClusterAdmissionPolicy</code> or <code>AdmissionPolicy</code> resource defines each policy.</p>
</div>
<div class="paragraph">
<p>A <code>ClusterAdmissionPolicy</code> and an <code>AdmissionPolicy</code> bind to a <code>policy-server</code>.
Any <code>ClusterAdmissionPolicy</code> not specifying a <code>policy-server</code>
binds to the default PolicyServer.
If a <code>ClusterAdmissionPolicy</code> references a <code>policy-server</code>
that doesn&#8217;t exist, its state is <code>unschedulable</code>.</p>
</div>
<div class="paragraph">
<p>Each <code>policy-server</code> defines many validation endpoints,
one for each policy defined in its configuration file.
You can load the same policy many times,
with different configuration parameters.</p>
</div>
<div class="paragraph">
<p>The <code>ValidatingWebhookConfiguration</code> and <code>MutatingWebhookConfiguration</code> resources
make the Kubernetes API server aware of these policies.
Then <code>kubewarden-controller</code> keeps the API server
and configuration resources in synchronization.</p>
</div>
<div class="paragraph">
<p>The Kubernetes API server dispatches incoming admission requests
to the correct validation endpoint exposed by <code>policy-server</code>.</p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="context-aware-policies.html">Context aware policies</a></span>
  <span class="next"><a href="../howtos/tasks.html">Common tasks</a></span>
</nav>
</article>
  </div>
</main>
</div>
<script src="../../../../_/js/site.js"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
<script src="../../../../_/js/vendor/lunr.js"></script>
<script src="../../../../_/js/vendor/lunr-languages.js"></script>
<script src="../../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../../.." data-snippet-length="100" data-stylesheet="../../../../_/css/search.css"></script>
<script async src="../../../../search-index.js"></script>
<script src="../../../../_/js/vendor/langSelection.js"></script>
<script async src="../../../../_/js/vendor/tabs.js"></script>


  </body>
</html>
