<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Threat Model :: Rancher product documentation</title>
    <link rel="canonical" href="https://documentation.suse.com/cloudnative/policy-manager/1.22/en/reference/threat-model.html">
    <link rel="prev" href="oci-registries-support.html">
    <link rel="next" href="policy-evaluation-timeout.html">
    <meta name="description" content="The Kubernetes Admission Control Threat Model and Kubewarden.">
    <meta name="keywords" content="["kubernetes", "admission control threat model", "kubewarden"]">
    <meta name="generator" content="Antora 3.1.10">
    <link rel="stylesheet" href="../../../../_/css/site.css">
<link rel="stylesheet" href="../../../../_/css/search.css">
<link rel="icon" href="../../../../_/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="../../../../_/css/font-styles.css">
<link rel="stylesheet" href="../../../../_/fonts/css/all.css">
<link rel="stylesheet" href="../../../../_/css/site-extra.css">
<link rel="stylesheet" href="../../../../_/css/vendor/tabs.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link
href="https://fonts.googleapis.com/css2?family=SUSE:wght@100..800&display=swap" rel="stylesheet">
<link href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css" rel="stylesheet">
<!-- <link href="https://fonts.googleapis.com/css?family=Montserrat|Roboto&display=swap" rel="stylesheet"> -->
<link rel="stylesheet" href="../../../../_/css/vendor/light.css">
<!-- <script src="/docserv/res/lightheaded/analytics.js"
        type="text/javascript"></script> -->
    <script>var uiRootPath = '../../../../_'</script>
  </head>
  <body class="article">
<script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs'; mermaid.initialize({"startOnLoad":true});</script><header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <div class="navbar-item">
        <a class=" navbar-logo" href="https://documentation.suse.com/" aria-label="SUSE Documentation Home"><img class="logo"
            src="../../../../_/img/logo.svg" alt="SUSE logo"/></a>
      </div>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <label class="visual-search-label" for="search-input">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label>
          <input label="Search" aria-label="Search" id="search-input" type="text" placeholder="Search the docs" >
        </div>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link">
            <img src="../../../../_/img/resources.png" class="langIcon Resurces" alt="Resources" title="Resources">
          </div>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://github.com/rancher/kubewarden-product-docs"><i class="fab fa-github"></i>&nbsp;Policy Manager</a>
            <div class="has-submenu">
              <a class="navbar-item" href="#" ><i class="fas fa-file-alt"></i>&nbsp;Report Issue &nbsp;<i class="fas fa-chevron-right"></i></a>
              <div class="submenu">
                <a class="navbar-item" href="https://scc.suse.com">SCC (Recommended)</a>
                <a class="navbar-item" href="https://github.com/rancher/kubewarden-product-docs/issues">GitHub Issue</a>
              </div>
            </div>
            <a class="navbar-item" href="https://github.com/rancher/product-docs-playbook/blob/main/CONTRIBUTING.md"><i class="fas fa-user-edit"></i>&nbsp;Contribute</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link"><img src="../../../../_/img/language.png" class="langIcon Language" alt="Language"
              title="Language"></div>
          <div class="navbar-dropdown">
            <!--  </div><div>Icons made by <a href="https://www.flaticon.com/authors/freepik" title="Freepik">Freepik</a> from <a href="https://www.flaticon.com/" title="Flaticon">www.flaticon.com</a></div> -->
              <a role="button" class="navbar-item" id="en" onclick="selectLanguage(this.id)">
                <!--<img src="../../../../_/img/engFlag.svg" class="langIcon english">-->
                &nbsp;English
              </a>
            <!-- LANGUAGESELECTOR -->
          </div>
        </div>
        <!--
        <div class="navbar-item">
          <a href="https://twitter.com/SUSE">
            <img alt="X-logo" class="x-logo" src="../../../../_/img/x-logo-white.png">
          </a>
        </div>
        -->
      </div>
    </div>

    <!--   <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">

        </div>
        <div class="navbar-item">
          <span class="control">
          </span>
        </div>
        <div class="navbar-item">
          <span class="control">
          </span>
        </div>
        <div class="navbar-item">
          <span class="control">
          </span>
        </div>
        <div class="navbar-item">
          <span class="control">
          </span>
        </div>
      </div> -->
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="policy-manager" data-version="1.20">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="../introduction.html">Policy Manager</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../introduction.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../quick-start.html">Quick start</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Tutorials</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../tutorials/writing-policies/index.html">Writing Kubewarden policies</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../tutorials/writing-policies/CEL/01-intro-cel.html">Introduction to CEL</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/CEL/02-reusing-vap.html">Reusing ValidatingAdmissionPolicies</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/CEL/03-context-aware.html">Context-aware CEL policies</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/CEL/04-example-sigstore.html">Sigstore host capabilities</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../tutorials/writing-policies/rust/01-intro-rust.html">Rust</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/rust/02-create-policy.html">Creating a policy</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/rust/03-define-policy-settings.html">Defining policy settings</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/rust/04-write-validation-logic.html">Writing validation logic</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/rust/05-mutation-policy.html">Creating a new mutation policy</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/rust/06-logging.html">Logging</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/rust/07-build-and-distribute.html">Building and distributing policies</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/rust/08-raw-policies.html">Raw policies</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../tutorials/writing-policies/go/01-intro-go.html">Writing policies in Go</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/go/02-scaffold.html">Creating a new validation policy</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/go/03-policy-settings.html">Defining policy settings</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/go/04-validation.html">Writing the validation logic</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/go/05-e2e-tests.html">End-to-end testing</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/go/06-logging.html">Logging</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/go/07-automate.html">Integrating with GitHub Actions</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/go/08-distribute.html">Distributing policy</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/go/09-validation-with-queries.html">Validation using JSON queries</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/go/10-raw-policies.html">Writing raw policies</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../tutorials/writing-policies/rego/01-intro-rego.html">Rego</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/rego/02-builtin-support.html">Builtin support</a>
  </li>
  <li class="nav-item" data-depth="4">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Open Policy Agent</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tutorials/writing-policies/rego/open-policy-agent/01-intro.html">Introduction to Open Policy Agent</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tutorials/writing-policies/rego/open-policy-agent/02-create-policy.html">Creating a new policy</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tutorials/writing-policies/rego/open-policy-agent/03-build-and-run.html">Build and run a OPA policy for Kubewarden</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tutorials/writing-policies/rego/open-policy-agent/04-distribute.html">Distributing an OPA policy with Kubewarden</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tutorials/writing-policies/rego/open-policy-agent/05-raw-policies.html">Writing raw policies</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="4">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Gatekeeper</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tutorials/writing-policies/rego/gatekeeper/01-intro.html">Gatekeeper support</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tutorials/writing-policies/rego/gatekeeper/02-create-policy.html">Creating a new Gatekeeper Rego policy</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tutorials/writing-policies/rego/gatekeeper/03-build-and-run.html">Build and run a Gatekeeper policy</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tutorials/writing-policies/rego/gatekeeper/04-distribute.html">Distributing a Gatekeeper policy with Kubewarden</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tutorials/writing-policies/dotnet.html">C#</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tutorials/writing-policies/swift.html">Swift</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tutorials/writing-policies/typescript.html">Typescript</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tutorials/writing-policies/other-languages.html">Other languages</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">WASI</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/wasi/01-intro-wasi.html">WASI</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/wasi/02-raw-policies.html">Writing raw policies</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tutorials/writing-policies/metadata.html">Policy metadata</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Testing policies</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tutorials/testing-policies/index.html">Policy testing</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tutorials/testing-policies/02-policy-authors.html">Testing for policy authors</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tutorials/testing-policies/03-cluster-operators.html">Testing for cluster operators</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tutorials/verifying-kubewarden.html">Verifying Kubewarden</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tutorials/publish-policy-to-artifact-hub.html">Publish policies to Artifact Hub</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Explanations</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../explanations/mutating-policies.html">Mutating policies</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../explanations/context-aware-policies.html">Context aware policies</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../explanations/policy-groups.html">Policy Groups</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../explanations/certificates.html">Certificate rotation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../explanations/distributing-policies.html">Distributing policies</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Comparisons</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../explanations/comparisons/opa-comparison.html">Kubewarden vs OPA Gatekeeper</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../explanations/audit-scanner/audit-scanner.html">What is the Audit Scanner?</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../explanations/audit-scanner/limitations.html">Audit Scanner - Limitations</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../explanations/audit-scanner/policy-reports.html">Audit Scanner - Policy Reports</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../explanations/architecture.html">Admission Policy Manager architecture</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Howtos</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../howtos/tasks.html">Common tasks</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../howtos/psp-migration.html">PodSecurityPolicy migration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../howtos/pod-security-admission-with-kubewarden.html">Using Pod Security Admission with Kubewarden</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../howtos/policy-groups.html">How to use policy groups</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../howtos/vap-migration.html">ValidatingAdmissionPolicy migration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../howtos/secure-supply-chain.html">Secure supply chain</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../howtos/custom-certificate-authorities.html">Custom certificate authorities</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../howtos/raw-policies.html">Raw policies</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../howtos/audit-scanner.html">Audit Scanner</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Configuring Policy Servers</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/policy-servers/01-custom-cas.html">Using custom certificate authorities</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/policy-servers/02-private-registry.html">Configuring PolicyServers to use private registries</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/policy-servers/03-production-deployments.html">Configuring PolicyServers for production</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../howtos/policies.html">Configuring policies</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Airgap</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/airgap/01-requirements.html">Requirements for a Kubewarden air gap installation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/airgap/02-install.html">Air gap installation</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Rancher UI extension</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/ui-extension/01-install.html">Rancher UI extension quickstart</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/ui-extension/02-metrics.html">Monitoring</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/ui-extension/03-tracing.html">Tracing</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Telemetry quick starts</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/telemetry/10-opentelemetry-qs.html">Open Telemetry quick start</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/telemetry/20-tracing-qs.html">Tracing quickstart</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/telemetry/30-metrics-qs.html">Metrics quickstart</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/telemetry/40-custom-otel-collector.html">Custom OpenTelemetry Collector</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../howtos/Rancher-Fleet.html">Managing Kubewarden with Rancher Fleet</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../howtos/contribution-guide/contribution-guide.html">Contribution guide</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/contribution-guide/contributing.html">Contributing to Kubewarden documentation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/contribution-guide/suggesting-an-improvement.html">Suggesting a doc improvement</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Reference</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="CRDs.html">Custom Resource Definitions (CRD)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dependency-matrix.html">Dependency matrix</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="artifacts.html">Artifacts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="upgrade-path.html">Upgrade path</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="metrics-reference.html">Metrics reference</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="monitor-mode.html">Monitor mode</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Policy specification</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="spec/01-intro-spec.html">Policy communication specification</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="spec/02-settings.html">Policy settings</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="spec/03-validating-policies.html">Validating policies</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="spec/04-mutating-policies.html">Mutating policies</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="spec/05-context-aware-policies.html">Context aware policies</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Host capabilities</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="spec/host-capabilities/01-intro-host-capabilities.html">Host capabilities specification</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="spec/host-capabilities/02-signature-verifier-policies.html">Signature verifier policies</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="spec/host-capabilities/03-container-registry.html">Container registry capabilities</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="spec/host-capabilities/04-net.html">Network capabilities</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="spec/host-capabilities/05-crypto.html">Cryptographic capabilities</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="spec/host-capabilities/06-kubernetes.html">Kubernetes capabilities</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="oci-registries-support.html">OCI registry support for Kubewarden</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="threat-model.html">Threat Model</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="policy-evaluation-timeout.html">Policy evaluation timeout protection</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="verification-config.html">Verification configuration format</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="sources_yaml.html">Reference for sources.yaml</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../glossary.html">Glossary</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../disclosure.html">Security disclosure</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Policy Manager</span>
    <span class="version">1.20</span>
  </div>
  <ul class="components">
        <li class="component">
          <div class="title"><a href="../../../../cluster-api/v0.16/en/index.html">Cluster API</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../cluster-api/v0.16/en/index.html">0.16</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.15/en/index.html">0.15</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.14/en/index.html">0.14</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.13/en/index.html">0.13</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.12/en/index.html">0.12</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.11/en/index.html">0.11</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../continuous-delivery/v0.11/en/index.html">Continuous Delivery</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../continuous-delivery/v0.11/en/index.html">0.11</a>
            </li>
            <li class="version">
              <a href="../../../../continuous-delivery/v0.10/en/index.html">0.10</a>
            </li>
            <li class="version">
              <a href="../../../../continuous-delivery/v0.9/en/index.html">0.9</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../k3s/latest/en/introduction.html">K3s</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../k3s/latest/en/introduction.html">Latest</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../os-manager/1.6/en/index.html">OS Manager</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../os-manager/1.6/en/index.html">1.6</a>
            </li>
            <li class="version">
              <a href="../../../../os-manager/1.5/en/index.html">1.5</a>
            </li>
          </ul>
        </li>
        <li class="component is-current">
          <div class="title"><a href="../../../1.22/en/introduction.html">Policy Manager</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../1.22/en/introduction.html">1.22-next</a>
            </li>
            <li class="version">
              <a href="../../../1.21/en/introduction.html">1.21</a>
            </li>
            <li class="version is-current">
              <a href="../introduction.html">1.20</a>
            </li>
            <li class="version">
              <a href="../../../1.19/en/introduction.html">1.19</a>
            </li>
            <li class="version">
              <a href="../../../1.18/en/introduction.html">1.18</a>
            </li>
            <li class="version">
              <a href="../../../1.17/en/introduction.html">1.17</a>
            </li>
            <li class="version">
              <a href="../../../1.16/en/introduction.html">1.16</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../rke2/latest/en/introduction.html">RKE2</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../rke2/latest/en/introduction.html">Latest</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../rancher-manager/latest/en/about-rancher/what-is-rancher.html">SUSE® Rancher Manager</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../rancher-manager/latest/en/about-rancher/what-is-rancher.html">Latest</a>
            </li>
            <li class="version">
              <a href="../../../../rancher-manager/v2.10/en/about-rancher/what-is-rancher.html">v2.10</a>
            </li>
            <li class="version">
              <a href="../../../../rancher-manager/v2.9/en/about-rancher/what-is-rancher.html">v2.9</a>
            </li>
            <li class="version">
              <a href="../../../../rancher-manager/v2.8/en/about-rancher/what-is-rancher.html">v2.8</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../security/5.4/en/overview.html">SUSE® Security</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../security/5.4/en/overview.html">5.4</a>
            </li>
            <li class="version">
              <a href="../../../../security/5.3/en/overview.html">5.3</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../storage/1.9.0/en/longhorn-documentation.html">SUSE® Storage</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../storage/1.9.0/en/longhorn-documentation.html">1.9.0 (Dev)</a>
            </li>
            <li class="version">
              <a href="../../../../storage/1.8.0/en/longhorn-documentation.html">1.8.0 (Latest)</a>
            </li>
            <li class="version">
              <a href="../../../../storage/1.7.0/en/longhorn-documentation.html">1.7.0</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../virtualization/v1.5/en/introduction/overview.html">SUSE® Virtualization</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../virtualization/v1.5/en/introduction/overview.html">v1.5 (Dev)</a>
            </li>
            <li class="version">
              <a href="../../../../virtualization/v1.4/en/introduction/overview.html">v1.4 (Latest)</a>
            </li>
            <li class="version">
              <a href="../../../../virtualization/v1.3/en/introduction/overview.html">v1.3</a>
            </li>
          </ul>
        </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../../rancher-manager/latest/en/about-rancher/what-is-rancher.html" aria-label="Home" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../introduction.html">Policy Manager</a></li>
    <li>Reference</li>
    <li><a href="threat-model.html">Threat Model</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">1.20</button>
  <div class="version-menu">
    <a class="version" href="../../../1.22/en/reference/threat-model.html">1.22-next</a>
    <a class="version" href="../../../1.21/en/reference/threat-model.html">1.21</a>
    <a class="version is-current" href="threat-model.html">1.20</a>
    <a class="version" href="../../../1.19/en/reference/threat-model.html">1.19</a>
    <a class="version" href="../../../1.18/en/reference/threat-model.html">1.18</a>
    <a class="version" href="../../../1.17/en/reference/threat-model.html">1.17</a>
    <a class="version" href="../../../1.16/en/reference/threat-model.html">1.16</a>
  </div>
</div>
  <div class="edit-this-page"><a href="https://github.com/rancher/kubewarden-product-docs/edit/main/docs/version-1.20/modules/en/pages/reference/threat-model.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="On this page" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Threat Model</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The <a href="https://github.com/kubernetes/community/tree/master/sig-security">Kubernetes Security Special Interest Group (SIG)</a> has defined an Admission Control Threat Model for Kubernetes.
The Kubewarden team continuously evaluates Kubewarden against this threat model, and works to provide secure defaults.
It&#8217;s recommended that Kubewarden administrators read and understand the threat model, and use it to devise their own circumstance specific threat model as needed.</p>
</div>
<div class="paragraph">
<p>Details about each threat is provided in the <a href="https://github.com/kubernetes/sig-security/tree/main/sig-security-docs/papers/admission-control">document published by SIG Security</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_kubernetes_threats"><a class="anchor" href="#_kubernetes_threats"></a>Kubernetes threats</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_threat_1_attacker_floods_webhook_with_traffic_preventing_its_operation"><a class="anchor" href="#_threat_1_attacker_floods_webhook_with_traffic_preventing_its_operation"></a>Threat 1 - Attacker floods webhook with traffic preventing its operation</h3>
<div class="sect3">
<h4 id="_scenario"><a class="anchor" href="#_scenario"></a>Scenario</h4>
<div class="paragraph">
<p>An attacker who has access to the Webhook endpoint,
at the network level,
could send large quantities of traffic,
causing an effective denial of service to the admission controller.</p>
</div>
</div>
<div class="sect3">
<h4 id="_mitigation"><a class="anchor" href="#_mitigation"></a>Mitigation</h4>
<div class="paragraph">
<p>Webhook fails closed.
if the webhook doesn&#8217;t respond in time,
for any reason, the API server should reject the request.
This is Kubewarden&#8217;s default behavior.</p>
</div>
<div class="paragraph">
<p>Failing closed means that if, for any reason,
Kubewarden stops responding or crashes,
the API server rejects the request by default.
This is even if the request would normally be accepted by Kubewarden.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_threat_2_attacker_passes_workloads_which_require_complex_processing_causing_timeouts"><a class="anchor" href="#_threat_2_attacker_passes_workloads_which_require_complex_processing_causing_timeouts"></a>Threat 2 - Attacker passes workloads which require complex processing causing timeouts</h3>
<div class="sect3">
<h4 id="_scenario_2"><a class="anchor" href="#_scenario_2"></a>Scenario</h4>
<div class="paragraph">
<p>An attacker, who can access the admission controller at a network level, passes
requests to the admission controller requiring complex processing and causing
timeouts as the admission controller uses compute power to process the workloads.</p>
</div>
</div>
<div class="sect3">
<h4 id="_mitigation_2"><a class="anchor" href="#_mitigation_2"></a>Mitigation</h4>
<div class="paragraph">
<p>Webhook fails closed and authenticate callers.
This is Kubewarden&#8217;s default behavior.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_threat_3_attacker_exploits_mis_configuration_of_webhook_to_bypass"><a class="anchor" href="#_threat_3_attacker_exploits_mis_configuration_of_webhook_to_bypass"></a>Threat 3 - Attacker exploits mis-configuration of webhook to bypass</h3>
<div class="sect3">
<h4 id="_scenario_3"><a class="anchor" href="#_scenario_3"></a>Scenario</h4>
<div class="paragraph">
<p>An attacker, who has rights to create workloads in the cluster, is able to exploit
a mis-configuration to bypass the intended security control.</p>
</div>
</div>
<div class="sect3">
<h4 id="_mitigation_3"><a class="anchor" href="#_mitigation_3"></a>Mitigation</h4>
<div class="paragraph">
<p>Regular reviews of webhook configuration can help catch issues.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_threat_4_attacker_has_rights_to_delete_or_modify_the_kubernetes_webhook_object"><a class="anchor" href="#_threat_4_attacker_has_rights_to_delete_or_modify_the_kubernetes_webhook_object"></a>Threat 4 - Attacker has rights to delete or modify the Kubernetes webhook object</h3>
<div class="sect3">
<h4 id="_scenario_4"><a class="anchor" href="#_scenario_4"></a>Scenario</h4>
<div class="paragraph">
<p>An attacker who has Kubernetes API access, has sufficient privileges to delete
the webhook object in the cluster.</p>
</div>
</div>
<div class="sect3">
<h4 id="_mitigation_4"><a class="anchor" href="#_mitigation_4"></a>Mitigation</h4>
<div class="paragraph">
<p>RBAC rights should be strictly controlled.</p>
</div>
</div>
<div class="sect3">
<h4 id="_to_do"><a class="anchor" href="#_to_do"></a>To-do</h4>
<div class="paragraph">
<p>Most of RBAC isn&#8217;t within the scope of the current discussion.
However, the following will be provided in due course for helping Kubewarden
users:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Directions around minimum RBAC to be implemented.</p>
</li>
<li>
<p>Provision &amp; documentation of a policy that detects and could block RBAC changes.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_threat_5_attacker_gets_access_to_valid_credentials_for_the_webhook"><a class="anchor" href="#_threat_5_attacker_gets_access_to_valid_credentials_for_the_webhook"></a>Threat 5 - Attacker gets access to valid credentials for the webhook</h3>
<div class="sect3">
<h4 id="_scenario_5"><a class="anchor" href="#_scenario_5"></a>Scenario</h4>
<div class="paragraph">
<p>An attacker gains access to valid client credentials for the admission controller webhook.</p>
</div>
</div>
<div class="sect3">
<h4 id="_mitigation_5"><a class="anchor" href="#_mitigation_5"></a>Mitigation</h4>
<div class="paragraph">
<p>Webhook fails closed.
This is Kubewarden&#8217;s default behavior.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_threat_6_attacker_gains_access_to_a_cluster_admin_credential"><a class="anchor" href="#_threat_6_attacker_gains_access_to_a_cluster_admin_credential"></a>Threat 6 - Attacker gains access to a cluster admin credential</h3>
<div class="sect3">
<h4 id="_scenario_6"><a class="anchor" href="#_scenario_6"></a>Scenario</h4>
<div class="paragraph">
<p>An attacker gains access to a cluster-admin level credential in the Kubernetes cluster.</p>
</div>
</div>
<div class="sect3">
<h4 id="_mitigation_6"><a class="anchor" href="#_mitigation_6"></a>Mitigation</h4>
<div class="paragraph">
<p>N/A</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_threat_7_attacker_sniffs_traffic_on_the_container_network"><a class="anchor" href="#_threat_7_attacker_sniffs_traffic_on_the_container_network"></a>Threat 7 - Attacker sniffs traffic on the container network</h3>
<div class="sect3">
<h4 id="_scenario_7"><a class="anchor" href="#_scenario_7"></a>Scenario</h4>
<div class="paragraph">
<p>An attacker who has access to the container network is able to sniff traffic
between the API server and the admission controller webhook.</p>
</div>
</div>
<div class="sect3">
<h4 id="_mitigation_7"><a class="anchor" href="#_mitigation_7"></a>Mitigation</h4>
<div class="paragraph">
<p>Since the webhook uses TLS encryption for all traffic, Kubewarden is safe.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_threat_8_attacker_carries_out_a_mitm_attack_on_the_webhook"><a class="anchor" href="#_threat_8_attacker_carries_out_a_mitm_attack_on_the_webhook"></a>Threat 8 - Attacker carries out a MITM attack on the webhook</h3>
<div class="sect3">
<h4 id="_scenario_8"><a class="anchor" href="#_scenario_8"></a>Scenario</h4>
<div class="paragraph">
<p>An attacker on the container network, who has access to the NET_RAW capability
can try to use MITM tooling to intercept traffic between the API server
and admission controller webhook.</p>
</div>
</div>
<div class="sect3">
<h4 id="_mitigation_8"><a class="anchor" href="#_mitigation_8"></a>Mitigation</h4>
<div class="paragraph">
<p>Webhook mTLS authentication should be used.
You should also use <a href="https://artifacthub.io/packages/kubewarden/capabilities-psp/capabilities-psp">capabilities-psp</a> and configure it to drop NET_RAW capabilities.</p>
</div>
</div>
<div class="sect3">
<h4 id="_to_do_2"><a class="anchor" href="#_to_do_2"></a>To-do</h4>
<div class="paragraph">
<p>Implement mutual TLS authentication.
Additionally, it would be possible to add a policy within the recommended
policies section in the <code>kubewarden-defaults</code> which drops the <code>NET_RAW</code>
capability.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_threat_9_attacker_steals_traffic_from_the_webhook_via_spoofing"><a class="anchor" href="#_threat_9_attacker_steals_traffic_from_the_webhook_via_spoofing"></a>Threat 9 - Attacker steals traffic from the webhook via spoofing</h3>
<div class="sect3">
<h4 id="_scenario_9"><a class="anchor" href="#_scenario_9"></a>Scenario</h4>
<div class="paragraph">
<p>An attacker is able to redirect traffic from the API server which is intended
for the admission controller webhook by spoofing.</p>
</div>
</div>
<div class="sect3">
<h4 id="_mitigation_9"><a class="anchor" href="#_mitigation_9"></a>Mitigation</h4>
<div class="paragraph">
<p>Webhook mTLS authentication is used.</p>
</div>
</div>
<div class="sect3">
<h4 id="_to_do_3"><a class="anchor" href="#_to_do_3"></a>To-do</h4>
<div class="paragraph">
<p>Kubewarden should implement mutual TLS authentication</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_threat_10_abusing_a_mutation_rule_to_create_a_privileged_container"><a class="anchor" href="#_threat_10_abusing_a_mutation_rule_to_create_a_privileged_container"></a>Threat 10 - Abusing a mutation rule to create a privileged container</h3>
<div class="sect3">
<h4 id="_scenario_10"><a class="anchor" href="#_scenario_10"></a>Scenario</h4>
<div class="paragraph">
<p>An attacker is able to cause a mutating admission controller to modify a workload,
such that it allows for privileged container creation.</p>
</div>
</div>
<div class="sect3">
<h4 id="_mitigation_10"><a class="anchor" href="#_mitigation_10"></a>Mitigation</h4>
<div class="paragraph">
<p>All rules should be reviewed and tested.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_threat_11_attacker_deploys_workloads_to_namespaces_that_are_exempt_from_admission_control"><a class="anchor" href="#_threat_11_attacker_deploys_workloads_to_namespaces_that_are_exempt_from_admission_control"></a>Threat 11 - Attacker deploys workloads to namespaces that are exempt from admission control</h3>
<div class="sect3">
<h4 id="_scenario_11"><a class="anchor" href="#_scenario_11"></a>Scenario</h4>
<div class="paragraph">
<p>An attacker is able to deploy workloads to Kubernetes namespaces that are exempt
from the admission controller configuration.</p>
</div>
</div>
<div class="sect3">
<h4 id="_mitigation_11"><a class="anchor" href="#_mitigation_11"></a>Mitigation</h4>
<div class="paragraph">
<p>RBAC rights are strictly controlled</p>
</div>
</div>
<div class="sect3">
<h4 id="_to_do_4"><a class="anchor" href="#_to_do_4"></a>To-do</h4>
<div class="paragraph">
<p>Most of the RBAC is out of scope with respect to this decision. However, the Kubewarden team aims to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Warn users via our docs and <em>suggest</em> some minimum RBAC to be used.</p>
</li>
<li>
<p>Provide a policy which detects RBAC changes and <strong>maybe</strong> block them.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_threat_12_block_rule_can_be_bypassed_due_to_missing_match_for_example_missing_initcontainers"><a class="anchor" href="#_threat_12_block_rule_can_be_bypassed_due_to_missing_match_for_example_missing_initcontainers"></a>Threat 12 - Block rule can be bypassed due to missing match (for example, missing initcontainers)</h3>
<div class="sect3">
<h4 id="_scenario_12"><a class="anchor" href="#_scenario_12"></a>Scenario</h4>
<div class="paragraph">
<p>An attacker created a workload manifest which uses a feature of the Kubernetes
API which is not covered by the admission controller</p>
</div>
</div>
<div class="sect3">
<h4 id="_mitigation_12"><a class="anchor" href="#_mitigation_12"></a>Mitigation</h4>
<div class="paragraph">
<p>All rules should be reviewed and tested. You should review PRs changing any rules in policies deployment.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_threat_13_attacker_exploits_bad_string_matching_on_a_blocklist_to_bypass_rules"><a class="anchor" href="#_threat_13_attacker_exploits_bad_string_matching_on_a_blocklist_to_bypass_rules"></a>Threat 13 - Attacker exploits bad string matching on a blocklist to bypass rules</h3>
<div class="sect3">
<h4 id="_scenario_13"><a class="anchor" href="#_scenario_13"></a>Scenario</h4>
<div class="paragraph">
<p>An attacker, who has rights to create workloads, bypasses a rule by exploiting
bad string matching.</p>
</div>
</div>
<div class="sect3">
<h4 id="_mitigation_13"><a class="anchor" href="#_mitigation_13"></a>Mitigation</h4>
<div class="paragraph">
<p>All rules should be reviewed and tested.</p>
</div>
</div>
<div class="sect3">
<h4 id="_to_do_5"><a class="anchor" href="#_to_do_5"></a>To-do</h4>
<div class="paragraph">
<p>Introduce tests to cover this rule.
As always, you should review PRs changing the rules in the policies deployment.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_threat_14_attacker_uses_newold_features_of_the_kubernetes_api_which_have_no_rules"><a class="anchor" href="#_threat_14_attacker_uses_newold_features_of_the_kubernetes_api_which_have_no_rules"></a>Threat 14 - Attacker uses new/old features of the Kubernetes API which have no rules</h3>
<div class="sect3">
<h4 id="_scenario_14"><a class="anchor" href="#_scenario_14"></a>Scenario</h4>
<div class="paragraph">
<p>An attacker, with rights to create workloads, uses new features of the Kubernetes
API (for example, a changed API version) to bypass a rule.</p>
</div>
</div>
<div class="sect3">
<h4 id="_mitigation_14"><a class="anchor" href="#_mitigation_14"></a>Mitigation</h4>
<div class="paragraph">
<p>All rules should be reviewed and tested. There is a policy that tests for the use of deprecated resources. It&#8217;s available from <a href="https://github.com/kubewarden/deprecated-api-versions-policy">the deprecated-api-versions-policy</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>deprecated-api-versions-policy</code> only deals with Custom Resources known to it. The threat is both deprecated resource versions, and new unknown ones that are misused, hence the policy only covers part
of the problem.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_threat_15_attacker_deploys_privileged_container_to_node_running_webhook_controller"><a class="anchor" href="#_threat_15_attacker_deploys_privileged_container_to_node_running_webhook_controller"></a>Threat 15 - Attacker deploys privileged container to node running Webhook controller</h3>
<div class="sect3">
<h4 id="_scenario_15"><a class="anchor" href="#_scenario_15"></a>Scenario</h4>
<div class="paragraph">
<p>An attacker, who has rights to deploy privileged containers to the cluster, creates
a privileged container on the cluster node where the admission controller webhook operates.</p>
</div>
</div>
<div class="sect3">
<h4 id="_mitigation_15"><a class="anchor" href="#_mitigation_15"></a>Mitigation</h4>
<div class="paragraph">
<p>Admission controller uses restrictive policies to prevent privileged workloads.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_threat_16_attacker_mounts_a_privileged_node_hostpath_allowing_modification_of_webhook_controller_configuration"><a class="anchor" href="#_threat_16_attacker_mounts_a_privileged_node_hostpath_allowing_modification_of_webhook_controller_configuration"></a>Threat 16 - Attacker mounts a privileged node hostpath allowing modification of Webhook controller configuration</h3>
<div class="sect3">
<h4 id="_scenario_16"><a class="anchor" href="#_scenario_16"></a>Scenario</h4>
<div class="paragraph">
<p>An attacker, who has rights to deploy hostPath volumes with workloads, creates a
volume that allows for access to the admission controller pod&#8217;s files.</p>
</div>
</div>
<div class="sect3">
<h4 id="_mitigation_16"><a class="anchor" href="#_mitigation_16"></a>Mitigation</h4>
<div class="paragraph">
<p>Admission controller uses restrictive policies to prevent privileged workloads</p>
</div>
</div>
<div class="sect3">
<h4 id="_to_do_6"><a class="anchor" href="#_to_do_6"></a>To-do</h4>
<div class="paragraph">
<p>Add a recommended policy in the <code>kubewarden-default</code> Helm chart to prevent this.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_threat_17_attacker_has_privileged_ssh_access_to_cluster_node_running_admission_webhook"><a class="anchor" href="#_threat_17_attacker_has_privileged_ssh_access_to_cluster_node_running_admission_webhook"></a>Threat 17 - Attacker has privileged SSH access to cluster node running admission webhook</h3>
<div class="sect3">
<h4 id="_scenario_17"><a class="anchor" href="#_scenario_17"></a>Scenario</h4>
<div class="paragraph">
<p>An attacker is able to log into cluster nodes as a privileged user via SSH.</p>
</div>
</div>
<div class="sect3">
<h4 id="_mitigation_17"><a class="anchor" href="#_mitigation_17"></a>Mitigation</h4>
<div class="paragraph">
<p>N/A</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_threat_18_attacker_uses_policies_to_send_confidential_data_from_admission_requests_to_external_systems"><a class="anchor" href="#_threat_18_attacker_uses_policies_to_send_confidential_data_from_admission_requests_to_external_systems"></a>Threat 18 - Attacker uses policies to send confidential data from admission requests to external systems</h3>
<div class="sect3">
<h4 id="_scenario_18"><a class="anchor" href="#_scenario_18"></a>Scenario</h4>
<div class="paragraph">
<p>An attacker is able to configure a policy that listens to admission requests and
sends sensitive data to an external system.</p>
</div>
</div>
<div class="sect3">
<h4 id="_mitigation_18"><a class="anchor" href="#_mitigation_18"></a>Mitigation</h4>
<div class="paragraph">
<p>Strictly control external access for webhook
Kubewarden policies run in a restrictive environment. They don&#8217;t have network access.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_kubewarden_threats"><a class="anchor" href="#_kubewarden_threats"></a>Kubewarden threats</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_kubewarden_threat_1_bootstrapping_of_trust_for_admission_controller"><a class="anchor" href="#_kubewarden_threat_1_bootstrapping_of_trust_for_admission_controller"></a>Kubewarden threat 1 - Bootstrapping of trust for admission controller</h3>
<div class="sect3">
<h4 id="_scenario_19"><a class="anchor" href="#_scenario_19"></a>Scenario</h4>
<div class="paragraph">
<p>Assuming a trusted but new Kubernetes cluster, an attacker is able to compromise the Kubewarden stack before any of the policies securing it are deployed and enforced.</p>
</div>
<div class="paragraph">
<p>For example, by:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>using unsigned and malicious images for:</p>
<div class="ulist">
<ul>
<li>
<p>Kubewarden-controller</p>
</li>
<li>
<p>policy-server</p>
</li>
<li>
<p>any of the Kubewarden dependencies</p>
</li>
<li>
<p>any optional dependencies (Grafana, Prometheus, and others)</p>
</li>
</ul>
</div>
</li>
<li>
<p>by compromising the Helm charts payload</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_mitigation_19"><a class="anchor" href="#_mitigation_19"></a>Mitigation</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Kubewarden provides a Software Bill Of Materials, which lists all images needed. This aids with Zero-Trust.
The Kubernetes Administrator must verify the Kubewarden images, its dependencies' images, and charts
out of the Kubernetes cluster, in a trusted environment.
This can be done with <code>cosign</code>, for example.
Incidentally, this is part of the implementation needed for air-gapped installations.</p>
</li>
<li>
<p>Use signed Helm charts, and verified digests instead of tags for Kubewarden images in those Helm charts.
This doesn&#8217;t secure dependencies though.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="oci-registries-support.html">OCI registry support for Kubewarden</a></span>
  <span class="next"><a href="policy-evaluation-timeout.html">Policy evaluation timeout protection</a></span>
</nav>
</article>
  </div>
</main>
</div>
<script src="../../../../_/js/site.js"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
<script src="../../../../_/js/vendor/lunr.js"></script>
<script src="../../../../_/js/vendor/lunr-languages.js"></script>
<script src="../../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../../.." data-snippet-length="100" data-stylesheet="../../../../_/css/search.css"></script>
<script async src="../../../../search-index.js"></script>
<script src="../../../../_/js/vendor/langSelection.js"></script>
<script async src="../../../../_/js/vendor/tabs.js"></script>


  </body>
</html>
