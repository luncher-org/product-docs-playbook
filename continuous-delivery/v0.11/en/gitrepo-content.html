<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Git Repository Contents :: Rancher product documentation</title>
    <link rel="canonical" href="https://documentation.suse.com/cloudnative/continuous-delivery/v0.11/en/gitrepo-content.html">
    <link rel="prev" href="ref-bundle-stages.html">
    <link rel="next" href="namespaces.html">
    <meta name="generator" content="Antora 3.1.10">
    <link rel="stylesheet" href="../../../_/css/site.css">
<link rel="stylesheet" href="../../../_/css/search.css">
<link rel="icon" href="../../../_/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="../../../_/css/font-styles.css">
<link rel="stylesheet" href="../../../_/fonts/css/all.css">
<link rel="stylesheet" href="../../../_/css/site-extra.css">
<link rel="stylesheet" href="../../../_/css/vendor/tabs.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link
href="https://fonts.googleapis.com/css2?family=SUSE:wght@100..800&display=swap" rel="stylesheet">
<link href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css" rel="stylesheet">
<!-- <link href="https://fonts.googleapis.com/css?family=Montserrat|Roboto&display=swap" rel="stylesheet"> -->
<link rel="stylesheet" href="../../../_/css/vendor/light.css">
<!-- <script src="/docserv/res/lightheaded/analytics.js"
        type="text/javascript"></script> -->
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs'; mermaid.initialize({"startOnLoad":true});</script><header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <div class="navbar-item">
        <a class=" navbar-logo" href="https://documentation.suse.com/" aria-label="SUSE Documentation Home"><img class="logo"
            src="../../../_/img/logo.svg" alt="SUSE logo"/></a>
      </div>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <label class="visual-search-label" for="search-input">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label>
          <input label="Search" aria-label="Search" id="search-input" type="text" placeholder="Search the docs" >
        </div>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link">
            <img src="../../../_/img/resources.png" class="langIcon Resurces" alt="Resources" title="Resources">
          </div>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://github.com/rancher/fleet-product-docs"><i class="fab fa-github"></i>&nbsp;Continuous Delivery</a>
            <div class="has-submenu">
              <a class="navbar-item" href="#" ><i class="fas fa-file-alt"></i>&nbsp;Report Issue &nbsp;<i class="fas fa-chevron-right"></i></a>
              <div class="submenu">
                <a class="navbar-item" href="https://scc.suse.com">SCC (Recommended)</a>
                <a class="navbar-item" href="https://github.com/rancher/fleet-product-docs/issues">GitHub Issue</a>
              </div>
            </div>
            <a class="navbar-item" href="https://github.com/rancher/product-docs-playbook/blob/main/CONTRIBUTING.md"><i class="fas fa-user-edit"></i>&nbsp;Contribute</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link"><img src="../../../_/img/language.png" class="langIcon Language" alt="Language"
              title="Language"></div>
          <div class="navbar-dropdown">
            <!--  </div><div>Icons made by <a href="https://www.flaticon.com/authors/freepik" title="Freepik">Freepik</a> from <a href="https://www.flaticon.com/" title="Flaticon">www.flaticon.com</a></div> -->
              <a role="button" class="navbar-item" id="en" onclick="selectLanguage(this.id)">
                <!--<img src="../../../_/img/engFlag.svg" class="langIcon english">-->
                &nbsp;English
              </a>
            <!-- LANGUAGESELECTOR -->
          </div>
        </div>
        <!--
        <div class="navbar-item">
          <a href="https://twitter.com/SUSE">
            <img alt="X-logo" class="x-logo" src="../../../_/img/x-logo-white.png">
          </a>
        </div>
        -->
      </div>
    </div>

    <!--   <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">

        </div>
        <div class="navbar-item">
          <span class="control">
          </span>
        </div>
        <div class="navbar-item">
          <span class="control">
          </span>
        </div>
        <div class="navbar-item">
          <span class="control">
          </span>
        </div>
        <div class="navbar-item">
          <span class="control">
          </span>
        </div>
      </div> -->
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="continuous-delivery" data-version="v0.11">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="index.html">Continuous Delivery</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="index.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Tutorials</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="quickstart.html">Quickstart</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="tut-deployment.html">Creating a Deployment</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="uninstall.html">Uninstall</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Explanations</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="architecture.html">Architecture</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="concepts.html">Core Concepts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ref-bundle-stages.html">Bundle Lifecycle</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="gitrepo-content.html">Git Repository Contents</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="namespaces.html">Namespaces</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="resources-during-deployment.html">Custom Resources During Deployment</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">How-tos for Operators</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="installation.html">Installation Details</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="cluster-registration.html">Register Downstream Clusters</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="cluster-group.html">Create Cluster Groups</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="multi-user.html">Setup Multi User</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">How-tos for Users</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="gitrepo-add.html">Create a GitRepo Resource</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="gitrepo-targets.html">Mapping to Downstream Clusters</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="bundle-diffs.html">Generating Diffs to Ignore Modified GitRepos</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="webhook.html">Using Webhooks Instead of Polling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="imagescan.html">Using Image Scan to Update Container Image References</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="bundle-add.html">Create a Bundle Resource</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Reference</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">CLI</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="cli/fleet-agent/fleet-agent.html">fleet-agent</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="cli/fleet-agent/fleet-agent_clusterstatus.html">fleet-agent clusterstatus</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="cli/fleet-agent/fleet-agent_register.html">fleet-agent register</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="cli/fleet-cli/fleet.html">fleet</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="cli/fleet-cli/fleet_apply.html">fleet apply</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="cli/fleet-cli/fleet_cleanup.html">fleet cleanup</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="cli/fleet-cli/fleet_deploy.html">fleet deploy</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="cli/fleet-cli/fleet_target.html">fleet target</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="cli/fleet-cli/fleet_test.html">fleet test</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="cli/fleet-controller/fleetcontroller.html">fleetcontroller</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="cli/fleet-controller/fleetcontroller_agentmanagement.html">fleetcontroller agentmanagement</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="cli/fleet-controller/fleetcontroller_cleanup.html">fleetcontroller cleanup</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ref-status-fields.html">Cluster and Bundle State</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="resources-list.html">Resources List</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ref-registration.html">Cluster Registration Internals</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ref-configuration.html">Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ref-resources.html">List of Deployed Resources</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ref-crds.html">Custom Resources Spec</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ref-fleet-yaml.html">fleet.yaml</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ref-gitrepo.html">GitRepo Resource</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ref-bundle.html">Bundle Resource</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="troubleshooting.html">Troubleshooting</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Changelog</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="v0.11.1.html">v0.11.1</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Continuous Delivery</span>
    <span class="version">0.11</span>
  </div>
  <ul class="components">
        <li class="component">
          <div class="title"><a href="../../../cluster-api/v0.16/en/index.html">Cluster API</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../cluster-api/v0.16/en/index.html">0.16</a>
            </li>
            <li class="version">
              <a href="../../../cluster-api/v0.15/en/index.html">0.15</a>
            </li>
            <li class="version">
              <a href="../../../cluster-api/v0.14/en/index.html">0.14</a>
            </li>
            <li class="version">
              <a href="../../../cluster-api/v0.13/en/index.html">0.13</a>
            </li>
            <li class="version">
              <a href="../../../cluster-api/v0.12/en/index.html">0.12</a>
            </li>
            <li class="version">
              <a href="../../../cluster-api/v0.11/en/index.html">0.11</a>
            </li>
          </ul>
        </li>
        <li class="component is-current">
          <div class="title"><a href="index.html">Continuous Delivery</a></div>
          <ul class="versions">
            <li class="version is-current is-latest">
              <a href="index.html">0.11</a>
            </li>
            <li class="version">
              <a href="../../v0.10/en/index.html">0.10</a>
            </li>
            <li class="version">
              <a href="../../v0.9/en/index.html">0.9</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../k3s/latest/en/introduction.html">K3s</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../k3s/latest/en/introduction.html">Latest</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../os-manager/1.6/en/index.html">OS Manager</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../os-manager/1.6/en/index.html">1.6</a>
            </li>
            <li class="version">
              <a href="../../../os-manager/1.5/en/index.html">1.5</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../policy-manager/1.22/en/introduction.html">Policy Manager</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../policy-manager/1.22/en/introduction.html">1.22-next</a>
            </li>
            <li class="version">
              <a href="../../../policy-manager/1.21/en/introduction.html">1.21</a>
            </li>
            <li class="version">
              <a href="../../../policy-manager/1.20/en/introduction.html">1.20</a>
            </li>
            <li class="version">
              <a href="../../../policy-manager/1.19/en/introduction.html">1.19</a>
            </li>
            <li class="version">
              <a href="../../../policy-manager/1.18/en/introduction.html">1.18</a>
            </li>
            <li class="version">
              <a href="../../../policy-manager/1.17/en/introduction.html">1.17</a>
            </li>
            <li class="version">
              <a href="../../../policy-manager/1.16/en/introduction.html">1.16</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../rke2/latest/en/introduction.html">RKE2</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../rke2/latest/en/introduction.html">Latest</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../rancher-manager/latest/en/about-rancher/what-is-rancher.html">SUSE® Rancher Manager</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../rancher-manager/latest/en/about-rancher/what-is-rancher.html">Latest</a>
            </li>
            <li class="version">
              <a href="../../../rancher-manager/v2.10/en/about-rancher/what-is-rancher.html">v2.10</a>
            </li>
            <li class="version">
              <a href="../../../rancher-manager/v2.9/en/about-rancher/what-is-rancher.html">v2.9</a>
            </li>
            <li class="version">
              <a href="../../../rancher-manager/v2.8/en/about-rancher/what-is-rancher.html">v2.8</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../security/5.4/en/overview.html">SUSE® Security</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../security/5.4/en/overview.html">5.4</a>
            </li>
            <li class="version">
              <a href="../../../security/5.3/en/overview.html">5.3</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../storage/1.9.0/en/longhorn-documentation.html">SUSE® Storage</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../storage/1.9.0/en/longhorn-documentation.html">1.9.0 (Dev)</a>
            </li>
            <li class="version">
              <a href="../../../storage/1.8.0/en/longhorn-documentation.html">1.8.0 (Latest)</a>
            </li>
            <li class="version">
              <a href="../../../storage/1.7.0/en/longhorn-documentation.html">1.7.0</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../virtualization/v1.5/en/introduction/overview.html">SUSE® Virtualization</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../virtualization/v1.5/en/introduction/overview.html">v1.5 (Dev)</a>
            </li>
            <li class="version">
              <a href="../../../virtualization/v1.4/en/introduction/overview.html">v1.4 (Latest)</a>
            </li>
            <li class="version">
              <a href="../../../virtualization/v1.3/en/introduction/overview.html">v1.3</a>
            </li>
          </ul>
        </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../rancher-manager/latest/en/about-rancher/what-is-rancher.html" aria-label="Home" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Continuous Delivery</a></li>
    <li>Explanations</li>
    <li><a href="gitrepo-content.html">Git Repository Contents</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">0.11</button>
  <div class="version-menu">
    <a class="version is-current" href="gitrepo-content.html">0.11</a>
    <a class="version" href="../../v0.10/en/gitrepo-content.html">0.10</a>
    <a class="version" href="../../v0.9/en/gitrepo-content.html">0.9</a>
  </div>
</div>
  <div class="edit-this-page"><a href="https://github.com/rancher/fleet-product-docs/edit/main/versions/v0.11/modules/en/pages/gitrepo-content.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="On this page" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Git Repository Contents</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>SUSE® Rancher Prime Continuous Delivery will create bundles from a git repository. This happens either explicitly by specifying paths, or when a <code>fleet.yaml</code> is found.</p>
</div>
<div class="paragraph">
<p>Each bundle is created from paths in a GitRepo and modified further by reading the discovered <code>fleet.yaml</code> file.
Bundle lifecycles are tracked between releases by the helm releaseName field added to each bundle. If the releaseName is not
specified within fleet.yaml it is generated from <code>GitRepo.name + path</code>. Long names are truncated and a <code>-&lt;hash&gt;</code> prefix is added.</p>
</div>
<div class="paragraph">
<p><strong>The git repository has no explicitly required structure.</strong> It is important
to realize the scanned resources will be saved as a resource in Kubernetes so
you want to make sure the directories you are scanning in git do not contain
arbitrarily large resources. Right now there is a limitation that the resources
deployed must <strong>gzip to less than 1MB</strong>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_repos_are_scanned"><a class="anchor" href="#_how_repos_are_scanned"></a>How repos are scanned</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Multiple paths can be defined for a <code>GitRepo</code> and each path is scanned independently.
Internally each scanned path will become a <a href="concepts.html" class="xref page">bundle</a> that SUSE® Rancher Prime Continuous Delivery will manage,
deploy, and monitor independently.</p>
</div>
<div class="paragraph">
<p>The following files are looked for to determine the how the resources will be deployed.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">File</th>
<th class="tableblock halign-left valign-top">Location</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Chart.yaml</strong>:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/ relative to <code>path</code> or custom path from <code>fleet.yaml</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The resources will be deployed as a Helm chart. Refer to the <code>fleet.yaml</code> for more options.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>kustomization.yaml</strong>:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/ relative to <code>path</code> or custom path from <code>fleet.yaml</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The resources will be deployed using Kustomize. Refer to the <code>fleet.yaml</code> for more options.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>fleet.yaml</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any subpath</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If any fleet.yaml is found a new <a href="concepts.html" class="xref page">bundle</a> will be defined. This allows mixing charts, kustomize, and raw YAML in the same repo</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong> *.yaml </strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any subpath</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If a <code>Chart.yaml</code> or <code>kustomization.yaml</code> is not found then any <code>.yaml</code> or <code>.yml</code> file will be assumed to be a Kubernetes resource and will be deployed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>overlays/{name}</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/ relative to <code>path</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When deploying using raw YAML (not Kustomize or Helm) <code>overlays</code> is a special directory for customizations.</p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="_excluding_files_and_directories_from_bundles"><a class="anchor" href="#_excluding_files_and_directories_from_bundles"></a>Excluding files and directories from bundles</h3>
<div class="paragraph">
<p>SUSE® Rancher Prime Continuous Delivery supports file and directory exclusion by means of <code>.fleetignore</code> files, in a similar fashion to how <code>.gitignore</code>
files behave in git repositories:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Glob syntax is used to match files or directories, using Golang&#8217;s
<a href="https://pkg.go.dev/path/filepath#Match"><code>filepath.Match</code></a></p>
</li>
<li>
<p>Empty lines are skipped, and can therefore be used to improve readability</p>
</li>
<li>
<p>Characters like white spaces and <code>#</code> can be escaped with a backslash</p>
</li>
<li>
<p>Trailing spaces are ignored, unless escaped</p>
</li>
<li>
<p>Comments, ie lines starting with unescaped <code>#</code>, are skipped</p>
</li>
<li>
<p>A given line can match a file or a directory, even if no separator is provided: eg. <code>subdir/*</code> and <code>subdir</code> are both
valid <code>.fleetignore</code> lines, and <code>subdir</code> matches both files and directories called <code>subdir</code></p>
</li>
<li>
<p>A match may be found for a file or directory at any level below the directory where a <code>.fleetignore</code> lives, ie
<code>foo.yaml</code> will match <code>./foo.yaml</code> as well as <code>./path/to/foo.yaml</code></p>
</li>
<li>
<p>Multiple <code>.fleetignore</code> files are supported. For instance, in the following directory structure, only
<code>root/something.yaml</code>, <code>bar/something2.yaml</code> and <code>foo/something.yaml</code> will end up in a bundle:</p>
<div class="listingblock">
<div class="content">
<pre>root/
├── .fleetignore            # contains `ignore-always.yaml'
├── something.yaml
├── bar
│   ├── .fleetignore        # contains `something.yaml`
│   ├── ignore-always.yaml
│   ├── something2.yaml
│   └── something.yaml
└── foo
    ├── ignore-always.yaml
    └── something.yaml</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>This currently comes with a few limitations, the following not being supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Double asterisks (<code>**</code>)</p>
</li>
<li>
<p>Explicit inclusions with <code>!</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_fleet_yaml"><a class="anchor" href="#_fleet_yaml"></a><code>fleet.yaml</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>fleet.yaml</code> is an optional file that can be included in the git repository to change the behavior of how
the resources are deployed and customized.  The <code>fleet.yaml</code> is always at the root relative to the <code>path</code> of the <code>GitRepo</code>
and if a subdirectory is found with a <code>fleet.yaml</code> a new <a href="concepts.html" class="xref page">bundle</a> is defined that will then be
configured differently from the parent bundle.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>Helm chart dependencies</strong>:
It is up to the user to fulfill the dependency list for the Helm charts. As such, you must manually run <code>helm dependencies update $chart</code> OR run <code>helm dependencies build $chart</code> prior to install. See the <a href="https://rancher.com/docs/rancher/v2.6/en/deploy-across-clusters/fleet/#helm-chart-dependencies">SUSE® Rancher Prime Continuous Delivery docs</a> in Rancher for more information.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The available fields are documented in the <a href="ref-fleet-yaml.html" class="xref page">fleet.yaml reference</a></p>
</div>
<div class="paragraph">
<p>For a private Helm repo, users can reference a secret from the git repo resource.
See <a href="gitrepo-add.html#_using_private_helm_repositories" class="xref page">Using Private Helm Repositories</a> for more information.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_helm_values"><a class="anchor" href="#_using_helm_values"></a>Using Helm Values</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>How changes are applied to <code>values.yaml</code></strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Note that the most recently applied changes to the <code>values.yaml</code> will override any previously existing values.</p>
</li>
<li>
<p>When changes are applied to the <code>values.yaml</code> from multiple sources at the same time, the values will update in the following order: <code>helm.values</code> -&gt; <code>helm.valuesFiles</code> -&gt; <code>helm.valuesFrom</code>. That means <code>valuesFrom</code> will take precedence over both, <code>valuesFiles</code> and <code>values</code>.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Credentials in Values</div>
<div class="paragraph">
<p>If the chart generates certificates or passwords in its templates, these values must be overriden. Otherwise the chart could be continuously deployed as these values change.</p>
</div>
<div class="paragraph">
<p>Credentials loaded from the downstream cluster with <code>valuesFrom</code> are by default encrypted at rest, when <a href="https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/">data encryption</a> is enabled in Kubernetes. Credentials contained in the default <code>values.yaml</code> file, or defined via <code>values:</code> or <code>valuesFiles</code> are not, as they are loaded from the repository when the bundle is created.</p>
</div>
<div class="paragraph">
<p>Hardened clusters should add the SUSE® Rancher Prime Continuous Delivery CRDs to the <a href="gitrepo-add.html#_storing_credentials_in_git" class="xref page">list of resources encrypted at rest</a>, on the upstream cluster, when storing credentials in the bundles.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_using_valuesfrom"><a class="anchor" href="#_using_valuesfrom"></a>Using ValuesFrom</h3>
<div class="paragraph">
<p>These examples showcase the style and format for using <code>valuesFrom</code>. ConfigMaps and Secrets should be created in <em>downstream clusters</em>.</p>
</div>
<div class="paragraph">
<p>Example <a href="https://kubernetes.io/docs/concepts/configuration/configmap/">ConfigMap</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: configmap-values
  namespace: default
data:
  values.yaml: |-
    replication: true
    replicas: 2
    serviceType: NodePort</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example <a href="https://kubernetes.io/docs/concepts/configuration/secret/">Secret</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: v1
kind: Secret
metadata:
  name: secret-values
  namespace: default
stringData:
  values.yaml: |-
    replication: true
    replicas: 3
    serviceType: NodePort</code></pre>
</div>
</div>
<div class="paragraph">
<p>A secret like that, can be created from a YAML file <code>secretdata.yaml</code> by running the following kubectl command: <code>kubectl create secret generic secret-values --from-file=values.yaml=secretdata.yaml</code></p>
</div>
<div class="paragraph">
<p>The resources can then be referenced from a <code>fleet.yaml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">helm:
  chart: simple-chart
  valuesFrom:
    - secretKeyRef:
        name: secret-values
        namespace: default
        key: values.yaml
    - configMapKeyRef:
        name: configmap-values
        namespace: default
        key: values.yaml
  values:
    replicas: "4"</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_per_cluster_customization"><a class="anchor" href="#_per_cluster_customization"></a>Per Cluster Customization</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>GitRepo</code> defines which clusters a git repository should be deployed to and the <code>fleet.yaml</code> in the repository
determines how the resources are customized per target.</p>
</div>
<div class="paragraph">
<p>All clusters and cluster groups in the same namespace as the <code>GitRepo</code> will be evaluated against all targets of that
<code>GitRepo</code>. The targets list is evaluated one by one and if there is a match the resource will be deployed to the cluster.
If no match is made against the target list on the <code>GitRepo</code> then the resources will not be deployed to that cluster.
Once a target cluster is matched the <code>fleet.yaml</code> from the git repository is then consulted for customizations. The
<code>targetCustomizations</code> in the <code>fleet.yaml</code> will be evaluated one by one and the first match will define how the
resource is to be configured. If no match is made the resources will be deployed with no additional customizations.</p>
</div>
<div class="paragraph">
<p>There are three approaches to matching clusters for both <code>GitRepo</code> <code>targets</code> and <code>fleet.yaml</code> <code>targetCustomizations</code>.
One can use cluster selectors, cluster group selectors, or an explicit cluster group name.  All criteria is additive so
the final match is evaluated as "clusterSelector &amp;&amp; clusterGroupSelector &amp;&amp; clusterGroup".  If any of the three have the
default value it is dropped from the criteria.  The default value is either null or "".  It is important to realize
that the value <code>{}</code> for a selector means "match everything."</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">targetCustomizations:
- name: all
  # Match everything
  clusterSelector: {}
- name: none
  # Selector ignored
  clusterSelector: null</code></pre>
</div>
</div>
<div class="paragraph">
<p>When matching a cluster by name, make sure to use the name of the
<code>clusters.fleet.cattle.io</code> resource. The Rancher UI also has a provisioning and
a management cluster resource. Since the management cluster resource is not
namespaced, its name is different and contains a random suffix.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">targetCustomizations:
- name: prod
  clusterName: fleetname</code></pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="gitrepo-targets#customization-per-cluster">Mapping to Downstream Clusters</a> for more information and a list of supported customizations.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_raw_yaml_resource_customization"><a class="anchor" href="#_raw_yaml_resource_customization"></a>Raw YAML Resource Customization</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When using Kustomize or Helm the <code>kustomization.yaml</code> or the <code>helm.values</code> will control how the resource are
customized per target cluster. If you are using raw YAML then the following simple mechanism is built-in and can
be used.  The <code>overlays/</code> folder in the git repo is treated specially as folder containing folders that
can be selected to overlay on top per target cluster. The resource overlay content
uses a file name based approach.  This is different from kustomize which uses a resource based approach.  In kustomize
the resource Group, Kind, Version, Name, and Namespace identify resources and are then merged or patched.  For Fleet
the overlay resources will override or patch content with a matching file name.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell"># Base files
deployment.yaml
svc.yaml

# Overlay files

# The following file will be added
overlays/custom/configmap.yaml
# The following file will replace svc.yaml
overlays/custom/svc.yaml
# The following file will patch deployment.yaml
overlays/custom/deployment_patch.yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p>A file named <code>foo</code> will replace a file called <code>foo</code> from the base resources or a previous overlay.  In order to patch
the contents of a file the convention of adding <code>_patch.</code> (notice the trailing period) to the filename is used. The string <code>_patch.</code>
will be replaced with <code>.</code> from the file name and that will be used as the target.  For example <code>deployment_patch.yaml</code>
will target <code>deployment.yaml</code>.  The patch will be applied using JSON Merge, Strategic Merge Patch, or JSON Patch.
Which strategy is used is based on the file content. Even though JSON strategies are used, the files can be written
using YAML syntax.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cluster_and_bundle_state"><a class="anchor" href="#_cluster_and_bundle_state"></a>Cluster and Bundle State</h2>
<div class="sectionbody">
<div class="paragraph">
<p>See <a href="ref-status-fields.html" class="xref page">Cluster and Bundle state</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_nested_gitrepo_crs"><a class="anchor" href="#_nested_gitrepo_crs"></a>Nested GitRepo CRs</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Nested <code>GitRepo CRs</code> (defining a <code>GitRepo</code> that points to a repository containing one or more <code>GitRepo</code> resources) is supported.
You can use this feature to take advantage of <code>GitOps</code> in your <code>GitRepo</code> resources or, for example, to split complex scenarios into more than one <code>GitRepo</code> resource.
When finding a <code>GitRepo</code> in a <code>Bundle</code> SUSE® Rancher Prime Continuous Delivery will simply deploy it as any other resource.</p>
</div>
<div class="paragraph">
<p>See <a href="https://github.com/rancher/fleet-examples/tree/master/single-cluster/multi-gitrepo">this example</a>.</p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="ref-bundle-stages.html">Bundle Lifecycle</a></span>
  <span class="next"><a href="namespaces.html">Namespaces</a></span>
</nav>
</article>
  </div>
</main>
</div>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/vendor/lunr-languages.js"></script>
<script src="../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../.." data-snippet-length="100" data-stylesheet="../../../_/css/search.css"></script>
<script async src="../../../search-index.js"></script>
<script src="../../../_/js/vendor/langSelection.js"></script>
<script async src="../../../_/js/vendor/tabs.js"></script>


  </body>
</html>
