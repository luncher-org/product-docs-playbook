<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Mapping to Downstream Clusters :: Rancher product documentation</title>
    <link rel="canonical" href="https://documentation.suse.com/cloudnative/continuous-delivery/v0.11/en/gitrepo-targets.html">
    <link rel="prev" href="gitrepo-add.html">
    <link rel="next" href="bundle-diffs.html">
    <meta name="generator" content="Antora 3.1.10">
    <link rel="stylesheet" href="../../../_/css/site.css">
<link rel="stylesheet" href="../../../_/css/search.css">
<link rel="icon" href="../../../_/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="../../../_/css/font-styles.css">
<link rel="stylesheet" href="../../../_/fonts/css/all.css">
<link rel="stylesheet" href="../../../_/css/site-extra.css">
<link rel="stylesheet" href="../../../_/css/vendor/tabs.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link
href="https://fonts.googleapis.com/css2?family=SUSE:wght@100..800&display=swap" rel="stylesheet">
<link href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css" rel="stylesheet">
<!-- <link href="https://fonts.googleapis.com/css?family=Montserrat|Roboto&display=swap" rel="stylesheet"> -->
<link rel="stylesheet" href="../../../_/css/vendor/light.css">
<!-- <script src="/docserv/res/lightheaded/analytics.js"
        type="text/javascript"></script> -->
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs'; mermaid.initialize({"startOnLoad":true});</script><header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <div class="navbar-item">
        <a class=" navbar-logo" href="https://documentation.suse.com/" aria-label="SUSE Documentation Home"><img class="logo"
            src="../../../_/img/logo.svg" alt="SUSE logo"/></a>
      </div>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <label class="visual-search-label" for="search-input">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label>
          <input label="Search" aria-label="Search" id="search-input" type="text" placeholder="Search the docs" >
        </div>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link">
            <img src="../../../_/img/resources.png" class="langIcon Resurces" alt="Resources" title="Resources">
          </div>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://github.com/rancher/fleet-product-docs"><i class="fab fa-github"></i>&nbsp;Continuous Delivery</a>
            <div class="has-submenu">
              <a class="navbar-item" href="#" ><i class="fas fa-file-alt"></i>&nbsp;Report Issue &nbsp;<i class="fas fa-chevron-right"></i></a>
              <div class="submenu">
                <a class="navbar-item" href="https://scc.suse.com">SCC (Recommended)</a>
                <a class="navbar-item" href="https://github.com/rancher/fleet-product-docs/issues">GitHub Issue</a>
              </div>
            </div>
            <a class="navbar-item" href="https://github.com/rancher/product-docs-playbook/blob/main/CONTRIBUTING.md"><i class="fas fa-user-edit"></i>&nbsp;Contribute</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link"><img src="../../../_/img/language.png" class="langIcon Language" alt="Language"
              title="Language"></div>
          <div class="navbar-dropdown">
            <!--  </div><div>Icons made by <a href="https://www.flaticon.com/authors/freepik" title="Freepik">Freepik</a> from <a href="https://www.flaticon.com/" title="Flaticon">www.flaticon.com</a></div> -->
              <a role="button" class="navbar-item" id="en" onclick="selectLanguage(this.id)">
                <!--<img src="../../../_/img/engFlag.svg" class="langIcon english">-->
                &nbsp;English
              </a>
            <!-- LANGUAGESELECTOR -->
          </div>
        </div>
        <!--
        <div class="navbar-item">
          <a href="https://twitter.com/SUSE">
            <img alt="X-logo" class="x-logo" src="../../../_/img/x-logo-white.png">
          </a>
        </div>
        -->
      </div>
    </div>

    <!--   <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">

        </div>
        <div class="navbar-item">
          <span class="control">
          </span>
        </div>
        <div class="navbar-item">
          <span class="control">
          </span>
        </div>
        <div class="navbar-item">
          <span class="control">
          </span>
        </div>
        <div class="navbar-item">
          <span class="control">
          </span>
        </div>
      </div> -->
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="continuous-delivery" data-version="v0.11">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="index.html">Continuous Delivery</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="index.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Tutorials</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="quickstart.html">Quickstart</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="tut-deployment.html">Creating a Deployment</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="uninstall.html">Uninstall</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Explanations</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="architecture.html">Architecture</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="concepts.html">Core Concepts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ref-bundle-stages.html">Bundle Lifecycle</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="gitrepo-content.html">Git Repository Contents</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="namespaces.html">Namespaces</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="resources-during-deployment.html">Custom Resources During Deployment</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">How-tos for Operators</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="installation.html">Installation Details</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="cluster-registration.html">Register Downstream Clusters</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="cluster-group.html">Create Cluster Groups</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="multi-user.html">Setup Multi User</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">How-tos for Users</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="gitrepo-add.html">Create a GitRepo Resource</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="gitrepo-targets.html">Mapping to Downstream Clusters</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="bundle-diffs.html">Generating Diffs to Ignore Modified GitRepos</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="webhook.html">Using Webhooks Instead of Polling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="imagescan.html">Using Image Scan to Update Container Image References</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="bundle-add.html">Create a Bundle Resource</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Reference</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">CLI</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="cli/fleet-agent/fleet-agent.html">fleet-agent</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="cli/fleet-agent/fleet-agent_clusterstatus.html">fleet-agent clusterstatus</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="cli/fleet-agent/fleet-agent_register.html">fleet-agent register</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="cli/fleet-cli/fleet.html">fleet</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="cli/fleet-cli/fleet_apply.html">fleet apply</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="cli/fleet-cli/fleet_cleanup.html">fleet cleanup</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="cli/fleet-cli/fleet_deploy.html">fleet deploy</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="cli/fleet-cli/fleet_target.html">fleet target</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="cli/fleet-cli/fleet_test.html">fleet test</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="cli/fleet-controller/fleetcontroller.html">fleetcontroller</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="cli/fleet-controller/fleetcontroller_agentmanagement.html">fleetcontroller agentmanagement</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="cli/fleet-controller/fleetcontroller_cleanup.html">fleetcontroller cleanup</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ref-status-fields.html">Cluster and Bundle State</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="resources-list.html">Resources List</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ref-registration.html">Cluster Registration Internals</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ref-configuration.html">Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ref-resources.html">List of Deployed Resources</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ref-crds.html">Custom Resources Spec</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ref-fleet-yaml.html">fleet.yaml</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ref-gitrepo.html">GitRepo Resource</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ref-bundle.html">Bundle Resource</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="troubleshooting.html">Troubleshooting</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Changelog</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="v0.11.1.html">v0.11.1</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Continuous Delivery</span>
    <span class="version">0.11</span>
  </div>
  <ul class="components">
        <li class="component">
          <div class="title"><a href="../../../cluster-api/v0.16/en/index.html">Cluster API</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../cluster-api/v0.16/en/index.html">0.16</a>
            </li>
            <li class="version">
              <a href="../../../cluster-api/v0.15/en/index.html">0.15</a>
            </li>
            <li class="version">
              <a href="../../../cluster-api/v0.14/en/index.html">0.14</a>
            </li>
            <li class="version">
              <a href="../../../cluster-api/v0.13/en/index.html">0.13</a>
            </li>
            <li class="version">
              <a href="../../../cluster-api/v0.12/en/index.html">0.12</a>
            </li>
            <li class="version">
              <a href="../../../cluster-api/v0.11/en/index.html">0.11</a>
            </li>
          </ul>
        </li>
        <li class="component is-current">
          <div class="title"><a href="index.html">Continuous Delivery</a></div>
          <ul class="versions">
            <li class="version is-current is-latest">
              <a href="index.html">0.11</a>
            </li>
            <li class="version">
              <a href="../../v0.10/en/index.html">0.10</a>
            </li>
            <li class="version">
              <a href="../../v0.9/en/index.html">0.9</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../k3s/latest/en/introduction.html">K3s</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../k3s/latest/en/introduction.html">Latest</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../os-manager/1.6/en/index.html">OS Manager</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../os-manager/1.6/en/index.html">1.6</a>
            </li>
            <li class="version">
              <a href="../../../os-manager/1.5/en/index.html">1.5</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../policy-manager/1.22/en/introduction.html">Policy Manager</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../policy-manager/1.22/en/introduction.html">1.22-next</a>
            </li>
            <li class="version">
              <a href="../../../policy-manager/1.21/en/introduction.html">1.21</a>
            </li>
            <li class="version">
              <a href="../../../policy-manager/1.20/en/introduction.html">1.20</a>
            </li>
            <li class="version">
              <a href="../../../policy-manager/1.19/en/introduction.html">1.19</a>
            </li>
            <li class="version">
              <a href="../../../policy-manager/1.18/en/introduction.html">1.18</a>
            </li>
            <li class="version">
              <a href="../../../policy-manager/1.17/en/introduction.html">1.17</a>
            </li>
            <li class="version">
              <a href="../../../policy-manager/1.16/en/introduction.html">1.16</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../rke2/latest/en/introduction.html">RKE2</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../rke2/latest/en/introduction.html">Latest</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../rancher-manager/latest/en/about-rancher/what-is-rancher.html">SUSE® Rancher Manager</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../rancher-manager/latest/en/about-rancher/what-is-rancher.html">Latest</a>
            </li>
            <li class="version">
              <a href="../../../rancher-manager/v2.10/en/about-rancher/what-is-rancher.html">v2.10</a>
            </li>
            <li class="version">
              <a href="../../../rancher-manager/v2.9/en/about-rancher/what-is-rancher.html">v2.9</a>
            </li>
            <li class="version">
              <a href="../../../rancher-manager/v2.8/en/about-rancher/what-is-rancher.html">v2.8</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../security/5.4/en/overview.html">SUSE® Security</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../security/5.4/en/overview.html">5.4</a>
            </li>
            <li class="version">
              <a href="../../../security/5.3/en/overview.html">5.3</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../storage/1.9.0/en/longhorn-documentation.html">SUSE® Storage</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../storage/1.9.0/en/longhorn-documentation.html">1.9.0 (Dev)</a>
            </li>
            <li class="version">
              <a href="../../../storage/1.8.0/en/longhorn-documentation.html">1.8.0 (Latest)</a>
            </li>
            <li class="version">
              <a href="../../../storage/1.7.0/en/longhorn-documentation.html">1.7.0</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../virtualization/v1.5/en/introduction/overview.html">SUSE® Virtualization</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../virtualization/v1.5/en/introduction/overview.html">v1.5 (Dev)</a>
            </li>
            <li class="version">
              <a href="../../../virtualization/v1.4/en/introduction/overview.html">v1.4 (Latest)</a>
            </li>
            <li class="version">
              <a href="../../../virtualization/v1.3/en/introduction/overview.html">v1.3</a>
            </li>
          </ul>
        </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../rancher-manager/latest/en/about-rancher/what-is-rancher.html" aria-label="Home" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Continuous Delivery</a></li>
    <li>How-tos for Users</li>
    <li><a href="gitrepo-targets.html">Mapping to Downstream Clusters</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">0.11</button>
  <div class="version-menu">
    <a class="version is-current" href="gitrepo-targets.html">0.11</a>
    <a class="version" href="../../v0.10/en/gitrepo-targets.html">0.10</a>
    <a class="version" href="../../v0.9/en/gitrepo-targets.html">0.9</a>
  </div>
</div>
  <div class="edit-this-page"><a href="https://github.com/rancher/fleet-product-docs/edit/main/versions/v0.11/modules/en/pages/gitrepo-targets.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="On this page" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Mapping to Downstream Clusters</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://rancher.com/docs/rancher/v2.6/en/deploy-across-clusters/fleet/">SUSE® Rancher Prime Continuous Delivery in Rancher</a> allows users to manage clusters easily as if they were one cluster. Users can deploy bundles, which can be comprised of deployment manifests or any other Kubernetes resource, across clusters using grouping configuration.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>Multi-cluster Only</strong>:
This approach only applies if you are running SUSE® Rancher Prime Continuous Delivery in a multi-cluster style
If no targets are specified, i.e. when using a single-cluster, the bundles target the default cluster group.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When deploying <code>GitRepos</code> to downstream clusters the clusters must be mapped to a target.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_defining_targets"><a class="anchor" href="#_defining_targets"></a>Defining Targets</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The deployment targets of <code>GitRepo</code> is done using the <code>spec.targets</code> field to
match clusters or cluster groups. The YAML specification is as below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">kind: GitRepo
apiVersion: fleet.cattle.io/v1alpha1
metadata:
  name: myrepo
  namespace: clusters
spec:
  repo: https://github.com/rancher/fleet-examples
  paths:
  - simple

  # Targets are evaluated in order and the first one to match is used. If
  # no targets match then the evaluated cluster will not be deployed to.
  targets:
  # The name of target. This value is largely for display and logging.
  # If not specified a default name of the format "target000" will be used
  - name: prod
    # A selector used to match clusters.  The structure is the standard
    # metav1.LabelSelector format. If clusterGroupSelector or clusterGroup is specified,
    # clusterSelector will be used only to further refine the selection after
    # clusterGroupSelector and clusterGroup is evaluated.
    clusterSelector:
      matchLabels:
        env: prod
    # A selector used to match cluster groups.
    clusterGroupSelector:
      matchLabels:
        region: us-east
    # A specific clusterGroup by name that will be selected
    clusterGroup: group1
    # A specific cluster by name that will be selected
    clusterName: cluster1</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_target_matching"><a class="anchor" href="#_target_matching"></a>Target Matching</h2>
<div class="sectionbody">
<div class="paragraph">
<p>All clusters and cluster groups in the same namespace as the <code>GitRepo</code> will be evaluated against all targets.
If any of the targets match the cluster then the <code>GitRepo</code> will be deployed to the downstream cluster. If
no match is made, then the <code>GitRepo</code> will not be deployed to that cluster.</p>
</div>
<div class="paragraph">
<p>There are three approaches to matching clusters.
One can use cluster selectors, cluster group selectors, or an explicit cluster group name.  All criteria is additive so
the final match is evaluated as "clusterSelector &amp;&amp; clusterGroupSelector &amp;&amp; clusterGroup".  If any of the three have the
default value it is dropped from the criteria.  The default value is either null or "".  It is important to realize
that the value <code>{}</code> for a selector means "match everything."</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">targets:
  # Match everything
  - clusterSelector: {}
  # Selector ignored
  - clusterSelector: null</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also match clusters by name:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">targets:
  - clusterName: fleetname</code></pre>
</div>
</div>
<div class="paragraph">
<p>When using SUSE® Rancher Prime Continuous Delivery in Rancher, make sure to put the name of the <code>clusters.fleet.cattle.io</code> resource.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_default_target"><a class="anchor" href="#_default_target"></a>Default Target</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If no target is set for the <code>GitRepo</code> then the default targets value is applied.  The default targets value is as below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">targets:
- name: default
  clusterGroup: default</code></pre>
</div>
</div>
<div class="paragraph">
<p>This means if you wish to setup a default location non-configured GitRepos will go to, then just create a cluster group called default
and add clusters to it.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_customization_per_cluster"><a class="anchor" href="#_customization_per_cluster"></a>Customization per Cluster</h2>
<div class="sectionbody">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>targets:</code> in the <code>GitRepo</code> resource select clusters to deploy on. The <code>targetCustomizations:</code> in <code>fleet.yaml</code> override Helm values only and do not change targeting.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To demonstrate how to deploy Kubernetes manifests across different clusters with customization using Fleet, we will use <a href="https://github.com/rancher/fleet-examples/blob/master/multi-cluster/helm/fleet.yaml">multi-cluster/helm/fleet.yaml</a>.</p>
</div>
<div class="paragraph">
<p><strong>Situation:</strong> User has three clusters with three different labels: <code>env=dev</code>, <code>env=test</code>, and <code>env=prod</code>. User wants to deploy a frontend application with a backend database across these clusters.</p>
</div>
<div class="paragraph">
<p><strong>Expected behavior:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>After deploying to the <code>dev</code> cluster, database replication is not enabled.</p>
</li>
<li>
<p>After deploying to the <code>test</code> cluster, database replication is enabled.</p>
</li>
<li>
<p>After deploying to the <code>prod</code> cluster, database replication is enabled and Load balancer services are exposed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Advantage of Fleet:</strong></p>
</div>
<div class="paragraph">
<p>Instead of deploying the app on each cluster, SUSE® Rancher Prime Continuous Delivery allows you to deploy across all clusters following these steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Deploy gitRepo <code>https://github.com/rancher/fleet-examples.git</code> and specify the path <code>multi-cluster/helm</code>.</p>
</li>
<li>
<p>Under <code>multi-cluster/helm</code>, a Helm chart will deploy the frontend app service and backend database service.</p>
</li>
<li>
<p>The following rule will be defined in <code>fleet.yaml</code>:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>targetCustomizations:
- name: dev
  helm:
    values:
      replication: false
  clusterSelector:
    matchLabels:
      env: dev

- name: test
  helm:
    values:
      replicas: 3
  clusterSelector:
    matchLabels:
      env: test

- name: prod
  helm:
    values:
      serviceType: LoadBalancer
      replicas: 3
  clusterSelector:
    matchLabels:
      env: prod</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Result:</strong></p>
</div>
<div class="paragraph">
<p>SUSE® Rancher Prime Continuous Delivery will deploy the Helm chart with your customized <code>values.yaml</code> to the different clusters.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Configuration management is not limited to deployments but can be expanded to general configuration management. SUSE® Rancher Prime Continuous Delivery is able to apply configuration management through customization among any set of clusters automatically.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_supported_customizations"><a class="anchor" href="#_supported_customizations"></a>Supported Customizations</h3>
<div class="ulist">
<ul>
<li>
<p><a href="ref-crds.html#_bundledeploymentoptions" class="xref page">DefaultNamespace</a></p>
</li>
<li>
<p><a href="ref-crds.html#_bundledeploymentoptions" class="xref page">ForceSyncGeneration</a></p>
</li>
<li>
<p><a href="ref-crds.html#_bundledeploymentoptions" class="xref page">KeepResources</a></p>
</li>
<li>
<p><a href="ref-crds.html#_bundledeploymentoptions" class="xref page">ServiceAccount</a></p>
</li>
<li>
<p><a href="ref-crds.html#_bundledeploymentoptions" class="xref page">TargetNamespace</a></p>
</li>
<li>
<p><a href="ref-crds.html#_helmoptions" class="xref page">Helm.Atomic</a></p>
</li>
<li>
<p><a href="ref-crds.html#_helmoptions" class="xref page">Helm.Chart</a></p>
</li>
<li>
<p><a href="ref-crds.html#_helmoptions" class="xref page">Helm.DisablePreProcess</a></p>
</li>
<li>
<p><a href="ref-crds.html#_helmoptions" class="xref page">Helm.Force</a></p>
</li>
<li>
<p><a href="ref-crds.html#_helmoptions" class="xref page">Helm.ReleaseName</a></p>
</li>
<li>
<p><a href="ref-crds.html#_helmoptions" class="xref page">Helm.Repo</a></p>
</li>
<li>
<p><a href="ref-crds.html#_helmoptions" class="xref page">Helm.TakeOwnership</a></p>
</li>
<li>
<p><a href="ref-crds.html#_helmoptions" class="xref page">Helm.TimeoutSeconds</a></p>
</li>
<li>
<p><a href="ref-crds.html#_helmoptions" class="xref page">Helm.ValuesFrom</a></p>
</li>
<li>
<p><a href="ref-crds.html#_helmoptions" class="xref page">Helm.Values</a></p>
</li>
<li>
<p><a href="ref-crds.html#_helmoptions" class="xref page">Helm.Version</a></p>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<div class="title">important information</div>
<div class="paragraph">
<p>Overriding the version of a Helm chart via target customizations will lead to bundles containing <em>all</em> versions, ie the
default one and the custom one(s), of the chart, to accommodate all clusters. This in turn means that SUSE® Rancher Prime Continuous Delivery will
deploy larger bundles.</p>
</div>
<div class="paragraph">
<p>+
As SUSE® Rancher Prime Continuous Delivery stores bundles via etcd, this may cause issues on some clusters where resultant bundle sizes may exceed
etcd&#8217;s configured maximum blob size. See <a href="https://github.com/rancher/fleet/issues/1650">this issue</a> for more details.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p><a href="ref-crds.html#_helmoptions" class="xref page">Helm.WaitForJobs</a></p>
</li>
<li>
<p><a href="ref-crds.html#_kustomizeoptions" class="xref page">Kustomize.Dir</a></p>
</li>
<li>
<p><a href="ref-crds.html#_yamloptions" class="xref page">YAML.Overlays</a></p>
</li>
<li>
<p><a href="ref-crds.html#_diffoptions" class="xref page">Diff.ComparePatches</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_additional_examples"><a class="anchor" href="#_additional_examples"></a>Additional Examples</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Examples using raw Kubernetes YAML, Helm charts, Kustomize, and combinations
of the three are in the <a href="https://github.com/rancher/fleet-examples/">SUSE® Rancher Prime Continuous Delivery Examples repo</a>.</p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="gitrepo-add.html">Create a GitRepo Resource</a></span>
  <span class="next"><a href="bundle-diffs.html">Generating Diffs to Ignore Modified GitRepos</a></span>
</nav>
</article>
  </div>
</main>
</div>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/vendor/lunr-languages.js"></script>
<script src="../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../.." data-snippet-length="100" data-stylesheet="../../../_/css/search.css"></script>
<script async src="../../../search-index.js"></script>
<script src="../../../_/js/vendor/langSelection.js"></script>
<script async src="../../../_/js/vendor/tabs.js"></script>


  </body>
</html>
